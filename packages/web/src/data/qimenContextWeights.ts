/**
 * 귀문둔갑 목적별 가중치 데이터
 *
 * 각 목적(context)에 따라 팔문, 구성, 팔신의 중요도가 달라짐
 * @author Claude Code
 * @version 2.0.0
 */

import type { Gate, Star, Spirit } from '@/types/qimen';

// ============================================
// 타입 정의
// ============================================

export type QimenContext = 'general' | 'business' | 'love' | 'travel' | 'health' | 'wealth' | 'lawsuit' | 'education' | 'meeting' | 'study' | 'relationship';

export interface ContextWeights {
  gates: Partial<Record<Gate, number>>;      // 팔문 가중치 (-1.0 ~ 1.0)
  stars: Partial<Record<Star, number>>;      // 구성 가중치 (-1.0 ~ 1.0)
  spirits: Partial<Record<Spirit, number>>;  // 팔신 가중치 (-1.0 ~ 1.0)
  description: string;                       // 목적 설명
  icon: string;                              // 아이콘
  keywords: string[];                        // 키워드
}

// ============================================
// 목적별 가중치 데이터
// ============================================

/**
 * 전체 목적별 가중치 맵
 *
 * 가중치 기준:
 *  1.0 = 매우 유리
 *  0.5 = 유리
 *  0.0 = 중립
 * -0.5 = 불리
 * -1.0 = 매우 불리
 */
export const CONTEXT_WEIGHTS: Record<QimenContext, ContextWeights> = {
  // ============================================
  // 일반 (기본)
  // ============================================
  general: {
    gates: {},
    stars: {},
    spirits: {},
    description: '일상적인 활동과 전반적인 운세',
    icon: '🌟',
    keywords: ['일상', '종합', '전체'],
  },

  // ============================================
  // 비즈니스 / 사업
  // ============================================
  business: {
    gates: {
      '생문': 1.0,   // 生門 - 새로운 사업, 성장
      '개문': 0.8,   // 開門 - 시작, 개방
      '경문': 0.7,   // 景門 - 명예, 홍보
      '휴문': 0.3,   // 休門 - 안정적 운영
      '두문': -0.8,  // 杜門 - 막힘, 폐쇄
      '사문': -1.0,  // 死門 - 종결, 실패
    },
    stars: {
      '천보': 1.0,   // 天輔 - 보좌, 협력
      '천임': 0.8,   // 天任 - 신뢰, 책임
      '천충': 0.5,   // 天冲 - 추진력
      '천영': 0.6,   // 天英 - 명성
      '천예': -0.9,  // 天芮 - 손실, 질병
      '천봉': -0.5,  // 天蓬 - 은밀함 (불투명)
    },
    spirits: {
      '직부': 1.0,   // 直符 - 권력, 승진
      '육합': 0.8,   // 六合 - 협상, 계약
      '구천': 0.7,   // 九天 - 공격적 전략
      '백호': -0.9,  // 白虎 - 갈등, 소송
      '현무': -0.8,  // 玄武 - 사기, 배신
    },
    description: '사업, 계약, 거래, 투자, 창업',
    icon: '💼',
    keywords: ['비즈니스', '사업', '계약', '거래', '투자', '창업'],
  },

  // ============================================
  // 연애 / 결혼
  // ============================================
  love: {
    gates: {
      '생문': 1.0,   // 生門 - 새로운 만남, 발전
      '개문': 0.7,   // 開門 - 새로운 시작
      '휴문': 0.8,   // 休門 - 평온한 관계
      '경문': 0.6,   // 景門 - 화려한 만남
      '상문': -0.7,  // 傷門 - 갈등, 상처
      '사문': -1.0,  // 死門 - 이별, 종결
    },
    stars: {
      '천임': 0.9,   // 天任 - 신뢰, 책임감
      '천보': 0.8,   // 天輔 - 지원, 조화
      '천심': 0.7,   // 天心 - 진심, 치유
      '천영': 0.5,   // 天英 - 열정
      '천예': -0.8,  // 天芮 - 질병, 고민
      '천충': -0.3,  // 天冲 - 충동적 (신중 필요)
    },
    spirits: {
      '육합': 1.0,   // 六合 - 화합, 결합
      '태음': 0.9,   // 太陰 - 은밀한 만남
      '직부': 0.6,   // 直符 - 정식 관계
      '백호': -0.9,  // 白虎 - 갈등, 싸움
      '등사': -0.7,  // 螣蛇 - 걱정, 번뇌
    },
    description: '연애, 만남, 결혼, 프로포즈, 중매',
    icon: '💕',
    keywords: ['연애', '사랑', '결혼', '만남', '프로포즈', '이성'],
  },

  // ============================================
  // 여행 / 이동
  // ============================================
  travel: {
    gates: {
      '개문': 1.0,   // 開門 - 출발, 시작
      '생문': 0.8,   // 生門 - 발전적 여행
      '휴문': 0.7,   // 休門 - 휴양
      '경문': 0.6,   // 景門 - 관광
      '두문': -0.9,  // 杜門 - 막힘, 지연
      '사문': -1.0,  // 死門 - 사고, 위험
    },
    stars: {
      '천충': 0.8,   // 天冲 - 빠른 이동
      '천보': 0.7,   // 天輔 - 안전한 여행
      '천임': 0.6,   // 天任 - 책임감 있는 이동
      '천영': 0.5,   // 天英 - 화려한 여행
      '천예': -0.9,  // 天芮 - 질병, 사고
      '천봉': -0.6,  // 天蓬 - 미로, 길 잃음
    },
    spirits: {
      '구천': 1.0,   // 九天 - 높이 날아감, 항공
      '직부': 0.7,   // 直符 - 순조로운 여행
      '육합': 0.6,   // 六合 - 동행자와 화합
      '백호': -0.9,  // 白虎 - 사고, 위험
      '현무': -0.8,  // 玄武 - 도난, 사기
    },
    description: '여행, 출장, 이사, 이동, 귀향',
    icon: '✈️',
    keywords: ['여행', '출장', '이사', '이동', '귀향', '관광'],
  },

  // ============================================
  // 건강 / 치료
  // ============================================
  health: {
    gates: {
      '휴문': 1.0,   // 休門 - 휴식, 회복
      '생문': 0.9,   // 生門 - 생명력, 재생
      '개문': 0.5,   // 開門 - 치료 시작
      '상문': -0.8,  // 傷門 - 부상, 상처
      '사문': -1.0,  // 死門 - 중병, 위험
      '두문': -0.6,  // 杜門 - 막힘, 정체
    },
    stars: {
      '천심': 1.0,   // 天心 - 의술, 치료
      '천임': 0.8,   // 天任 - 신뢰, 안정
      '천보': 0.7,   // 天輔 - 보조, 지원
      '천금': 0.6,   // 天禽 - 균형
      '천예': -1.0,  // 天芮 - 질병의 별
      '천봉': -0.7,  // 天蓬 - 은폐된 병
    },
    spirits: {
      '직부': 0.8,   // 直符 - 정확한 진단
      '태음': 0.7,   // 太陰 - 회복, 조용한 치유
      '구지': 0.9,   // 九地 - 안정, 요양
      '백호': -1.0,  // 白虎 - 흉, 수술
      '등사': -0.8,  // 螣蛇 - 걱정, 불안
    },
    description: '건강, 치료, 수술, 검진, 요양',
    icon: '🏥',
    keywords: ['건강', '치료', '병원', '수술', '검진', '요양'],
  },

  // ============================================
  // 재물 / 투자
  // ============================================
  wealth: {
    gates: {
      '생문': 1.0,   // 生門 - 재물 생성
      '개문': 0.8,   // 開門 - 새로운 수입원
      '경문': 0.7,   // 景門 - 명예로 인한 재물
      '휴문': 0.5,   // 休門 - 안정적 수입
      '사문': -1.0,  // 死門 - 손실, 파산
      '두문': -0.7,  // 杜門 - 막힘, 손실
    },
    stars: {
      '천보': 1.0,   // 天輔 - 재물운
      '천임': 0.8,   // 天任 - 신뢰할 수 있는 투자
      '천금': 0.7,   // 天禽 - 중심, 균형 투자
      '천영': 0.5,   // 天英 - 화려한 이익
      '천예': -0.9,  // 天芮 - 손실
      '천봉': -0.6,  // 天蓬 - 불투명한 투자
    },
    spirits: {
      '직부': 0.9,   // 直符 - 정당한 이익
      '육합': 0.7,   // 六合 - 협력 투자
      '구천': 0.6,   // 九天 - 공격적 투자
      '현무': -1.0,  // 玄武 - 사기, 도박
      '백호': -0.8,  // 白虎 - 갈등으로 인한 손실
    },
    description: '투자, 재테크, 사업 자금, 계약금',
    icon: '💰',
    keywords: ['재물', '투자', '재테크', '수입', '돈', '자금'],
  },

  // ============================================
  // 소송 / 법률
  // ============================================
  lawsuit: {
    gates: {
      '경문': 1.0,   // 景門 - 명분, 증거
      '개문': 0.6,   // 開門 - 공개, 투명
      '휴문': 0.5,   // 休門 - 화해
      '상문': -0.3,  // 傷門 - 공격적 (신중 필요)
      '사문': -0.8,  // 死門 - 패소 위험
      '두문': -0.5,  // 杜門 - 막힘
    },
    stars: {
      '천영': 0.9,   // 天英 - 명분, 공정
      '천임': 0.8,   // 天任 - 신뢰, 정직
      '천충': 0.4,   // 天冲 - 추진력 (공격)
      '천예': -0.9,  // 天芮 - 불리, 악화
      '천봉': -0.7,  // 天蓬 - 음모, 불리
    },
    spirits: {
      '직부': 1.0,   // 直符 - 정의, 승소
      '육합': 0.7,   // 六合 - 합의, 화해
      '구천': 0.5,   // 九天 - 공개적 대응
      '백호': -1.0,  // 白虎 - 갈등 격화
      '현무': -0.9,  // 玄武 - 배신, 사기
    },
    description: '소송, 법률, 분쟁, 계약 문제, 고소',
    icon: '⚖️',
    keywords: ['소송', '법률', '분쟁', '재판', '고소', '계약'],
  },

  // ============================================
  // 교육 / 학업
  // ============================================
  education: {
    gates: {
      '생문': 1.0,   // 生門 - 성장, 발전
      '개문': 0.9,   // 開門 - 새로운 배움
      '경문': 0.8,   // 景門 - 명예, 성과
      '휴문': 0.6,   // 休門 - 안정적 학습
      '두문': -0.7,  // 杜門 - 막힘, 어려움
      '놀문': -0.4,  // 驚門 - 시험 불안
    },
    stars: {
      '천보': 0.9,   // 天輔 - 학습 능력
      '천임': 0.8,   // 天任 - 성실함
      '천심': 0.7,   // 天心 - 지혜
      '천영': 0.8,   // 天英 - 명예, 상
      '천충': 0.5,   // 天冲 - 추진력
      '천예': -0.8,  // 天芮 - 학업 부진
    },
    spirits: {
      '직부': 0.9,   // 直符 - 합격, 성공
      '육합': 0.7,   // 六合 - 그룹 학습
      '태음': 0.6,   // 太陰 - 조용한 학습
      '등사': -0.7,  // 螣蛇 - 불안, 걱정
      '백호': -0.6,  // 白虎 - 시험 실패
    },
    description: '시험, 입학, 학업, 자격증, 교육',
    icon: '📚',
    keywords: ['시험', '학업', '입학', '자격증', '공부', '교육'],
  },

  // ============================================
  // 회의 / 미팅
  // ============================================
  meeting: {
    gates: {
      '생문': 0.8,   // 生門 - 생산적 회의
      '개문': 0.9,   // 開門 - 소통, 개방
      '경문': 0.7,   // 景門 - 발표, 프레젠테이션
      '휴문': 0.5,   // 休門 - 원활한 진행
      '두문': -0.8,  // 杜門 - 의견 차단
      '상문': -0.7,  // 傷門 - 갈등
    },
    stars: {
      '천보': 0.9,   // 天輔 - 협력
      '천임': 0.8,   // 天任 - 신뢰
      '천충': 0.6,   // 天冲 - 추진력
      '천심': 0.7,   // 天心 - 지혜로운 결정
      '천예': -0.8,  // 天芮 - 문제 발생
      '천봉': -0.5,  // 天蓬 - 불투명함
    },
    spirits: {
      '직부': 0.8,   // 直符 - 리더십
      '육합': 1.0,   // 六合 - 합의, 협상
      '구천': 0.6,   // 九天 - 적극성
      '백호': -0.9,  // 白虎 - 갈등
      '등사': -0.7,  // 螣蛇 - 불안, 혼란
    },
    description: '회의, 미팅, 상담, 협상, 토의',
    icon: '🤝',
    keywords: ['회의', '미팅', '상담', '협상', '토론', '논의'],
  },

  // ============================================
  // 학습 / 연구
  // ============================================
  study: {
    gates: {
      '생문': 1.0,   // 生門 - 성장, 발전
      '개문': 0.9,   // 開門 - 새로운 지식
      '휴문': 0.8,   // 休門 - 안정적 학습
      '경문': 0.6,   // 景門 - 발표, 논문
      '두문': 0.5,   // 杜門 - 집중, 은둔 학습
      '놀문': -0.4,  // 驚門 - 불안
    },
    stars: {
      '천보': 1.0,   // 天輔 - 학습 능력
      '천임': 0.9,   // 天任 - 성실함
      '천심': 0.9,   // 天心 - 지혜, 통찰
      '천영': 0.7,   // 天英 - 열정
      '천충': 0.5,   // 天冲 - 추진력
      '천예': -0.9,  // 天芮 - 학습 부진
    },
    spirits: {
      '직부': 0.8,   // 直符 - 성과
      '태음': 0.9,   // 太陰 - 조용한 학습
      '육합': 0.7,   // 六合 - 그룹 학습
      '구지': 0.6,   // 九地 - 깊은 연구
      '백호': -0.7,  // 白虎 - 장애
    },
    description: '학습, 연구, 독서, 자기개발',
    icon: '📖',
    keywords: ['학습', '연구', '독서', '자기계발', '공부', '지식'],
  },

  // ============================================
  // 인간관계 / 대인관계
  // ============================================
  relationship: {
    gates: {
      '생문': 0.9,   // 生門 - 새로운 관계
      '개문': 0.8,   // 開門 - 소통
      '휴문': 0.9,   // 休門 - 평화로운 관계
      '경문': 0.6,   // 景門 - 사교적 만남
      '상문': -0.9,  // 傷門 - 갈등
      '사문': -0.8,  // 死門 - 관계 단절
    },
    stars: {
      '천보': 1.0,   // 天輔 - 도움, 협력
      '천임': 0.9,   // 天任 - 신뢰
      '천심': 0.8,   // 天心 - 이해, 공감
      '천영': 0.6,   // 天英 - 열정적 관계
      '천예': -0.9,  // 天芮 - 문제, 질병
      '천충': -0.3,  // 天冲 - 충동적 (신중 필요)
    },
    spirits: {
      '육합': 1.0,   // 六合 - 화합
      '직부': 0.7,   // 直符 - 정직한 관계
      '태음': 0.8,   // 太陰 - 은밀한 관계
      '백호': -1.0,  // 白虎 - 갈등, 싸움
      '등사': -0.8,  // 螣蛇 - 불안, 오해
    },
    description: '인간관계, 대인관계, 사귐, 친구',
    icon: '👥',
    keywords: ['인간관계', '대인관계', '친구', '사귐', '소통', '화합'],
  },
};

// ============================================
// 유틸리티 함수
// ============================================

/**
 * 목적에 따른 가중치 가져오기
 */
export function getContextWeights(context?: QimenContext): ContextWeights {
  return CONTEXT_WEIGHTS[context || 'general'];
}

/**
 * 모든 목적 목록 가져오기
 */
export function getAllContexts(): Array<{ value: QimenContext; label: string; icon: string; description: string }> {
  return Object.entries(CONTEXT_WEIGHTS).map(([key, data]) => ({
    value: key as QimenContext,
    label: getContextLabel(key as QimenContext),
    icon: data.icon,
    description: data.description,
  }));
}

/**
 * 목적 레이블 한글화
 */
export function getContextLabel(context: QimenContext): string {
  const labels: Record<QimenContext, string> = {
    general: '일반 (전체)',
    business: '비즈니스',
    love: '연애/결혼',
    travel: '여행/이동',
    health: '건강/치료',
    wealth: '재물/투자',
    lawsuit: '소송/법률',
    education: '교육/학업',
    meeting: '회의/미팅',
    study: '학습/연구',
    relationship: '인간관계',
  };
  return labels[context];
}
