import{r as e,j as r,e as a}from"./react-vendor-BqNk2DgB.js";import{c as t,a as s}from"./customerApi-JV4xNEmH.js";function l({isOpen:a,onClose:s,onCustomerAdded:l}){const[d,n]=e.useState({name:"",birth_date:"",birth_time:"",phone:"",lunar_solar:"solar",gender:"male",memo:""}),[o,i]=e.useState({}),[c,x]=e.useState(!1),[m,u]=e.useState(null),b=e.useCallback(()=>{c||(g(),s())},[c,s]);e.useEffect(()=>{a&&g()},[a]),e.useEffect(()=>{const e=e=>{"Escape"===e.key&&a&&b()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a,b]);const g=()=>{n({name:"",birth_date:"",birth_time:"",phone:"",lunar_solar:"solar",gender:"male",memo:""}),i({}),u(null)},h=(e,r)=>{"phone"===e&&(r=(e=>{const r=e.replace(/[^\d]/g,"");return r.length<=3?r:r.length<=7?`${r.slice(0,3)}-${r.slice(3)}`:`${r.slice(0,3)}-${r.slice(3,7)}-${r.slice(7,11)}`})(r)),n(a=>({...a,[e]:r})),o[e]&&i(r=>({...r,[e]:void 0})),m&&u(null)};return a?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",onClick:e=>{e.target===e.currentTarget&&b()},role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto transform transition-all duration-300 scale-100",children:[r.jsx("div",{className:"sticky top-0 bg-white dark:bg-gray-800 px-6 py-4 border-b border-gray-200 dark:border-gray-700 rounded-t-2xl",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h2",{id:"modal-title",className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[r.jsx("span",{className:"text-2xl",children:"ğŸ‘¤"}),"ìƒˆ ê³ ê° ë“±ë¡"]}),r.jsx("button",{onClick:b,disabled:c,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors disabled:opacity-50","aria-label":"ëª¨ë‹¬ ë‹«ê¸°",children:r.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),r.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};if(d.name.trim()?d.name.length<2&&(e.name="ì´ë¦„ì€ 2ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”"):e.name="ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”",d.birth_date){const r=new Date(d.birth_date),a=new Date,t=new Date(1900,0,1);r>a?e.birth_date="ë¯¸ë˜ ë‚ ì§œëŠ” ì„ íƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤":r<t&&(e.birth_date="1900ë…„ ì´í›„ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”")}else e.birth_date="ìƒë…„ì›”ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”";d.birth_time||(e.birth_time="ìƒì‹œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),d.phone.trim()?/^010-\d{4}-\d{4}$/.test(d.phone)||(e.phone="ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤ (ì˜ˆ: 010-1234-5678)"):e.phone="ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”";return i(e),0===Object.keys(e).length})()){x(!0),u(null);try{const e={name:d.name.trim(),birth_date:d.birth_date,birth_time:d.birth_time,phone:d.phone,lunar_solar:d.lunar_solar,gender:d.gender,memo:d.memo.trim()},r=await t(e);u({type:"success",text:"ê³ ê°ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!"}),setTimeout(()=>{l(r.data),b()},500)}catch(r){u({type:"error",text:r instanceof Error?r.message:"ê³ ê° ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"})}finally{x(!1)}}},className:"p-6",children:[r.jsxs("div",{className:"space-y-5",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:[r.jsx("span",{className:"text-red-500",children:"*"})," ì´ë¦„"]}),r.jsx("input",{type:"text",value:d.name,onChange:e=>h("name",e.target.value),className:`w-full px-4 py-3 border rounded-xl transition-colors\n                  ${o.name?"border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500"}\n                  dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2`,placeholder:"ê³ ê° ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”",disabled:c,autoComplete:"name"}),o.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.name})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:[r.jsx("span",{className:"text-red-500",children:"*"})," ìƒë…„ì›”ì¼"]}),r.jsx("input",{type:"date",value:d.birth_date,onChange:e=>h("birth_date",e.target.value),max:(new Date).toISOString().split("T")[0],min:"1900-01-01",className:`w-full px-4 py-3 border rounded-xl transition-colors\n                  ${o.birth_date?"border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500"}\n                  dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2`,disabled:c}),o.birth_date&&r.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.birth_date})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:[r.jsx("span",{className:"text-red-500",children:"*"})," ìƒì‹œ (24ì‹œê°„ í˜•ì‹)"]}),r.jsx("input",{type:"time",value:d.birth_time,onChange:e=>h("birth_time",e.target.value),className:`w-full px-4 py-3 border rounded-xl transition-colors\n                  ${o.birth_time?"border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500"}\n                  dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2`,disabled:c}),o.birth_time&&r.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.birth_time})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:[r.jsx("span",{className:"text-red-500",children:"*"})," ì „í™”ë²ˆí˜¸"]}),r.jsx("input",{type:"tel",value:d.phone,onChange:e=>h("phone",e.target.value),className:`w-full px-4 py-3 border rounded-xl transition-colors\n                  ${o.phone?"border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500"}\n                  dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2`,placeholder:"010-1234-5678",disabled:c,autoComplete:"tel"}),o.phone&&r.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.phone})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-3 text-gray-700 dark:text-gray-300",children:"ìŒë ¥/ì–‘ë ¥"}),r.jsxs("div",{className:"flex gap-6",children:[r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{type:"radio",value:"solar",checked:"solar"===d.lunar_solar,onChange:()=>h("lunar_solar","solar"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500",disabled:c}),r.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"ğŸŒ ì–‘ë ¥"})]}),r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{type:"radio",value:"lunar",checked:"lunar"===d.lunar_solar,onChange:()=>h("lunar_solar","lunar"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500",disabled:c}),r.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"ğŸŒ™ ìŒë ¥"})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium mb-3 text-gray-700 dark:text-gray-300",children:[r.jsx("span",{className:"text-red-500",children:"*"})," ì„±ë³„"]}),r.jsxs("div",{className:"flex gap-6",children:[r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{type:"radio",value:"male",checked:"male"===d.gender,onChange:()=>h("gender","male"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500",disabled:c}),r.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"ğŸ‘¨ ë‚¨ì„±"})]}),r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{type:"radio",value:"female",checked:"female"===d.gender,onChange:()=>h("gender","female"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500",disabled:c}),r.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"ğŸ‘© ì—¬ì„±"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"ë©”ëª¨"}),r.jsx("textarea",{value:d.memo,onChange:e=>h("memo",e.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl\n                         dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors resize-none",placeholder:"ê³ ê°ì— ëŒ€í•œ ì¶”ê°€ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)",disabled:c})]}),m&&r.jsx("div",{className:"p-4 rounded-xl text-sm font-medium "+("success"===m.type?"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300 border border-red-200 dark:border-red-800"),children:r.jsxs("div",{className:"flex items-center gap-2",children:["success"===m.type?r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),m.text]})})]}),r.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[r.jsx("button",{type:"button",onClick:b,disabled:c,className:"px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300\n                       rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"ì·¨ì†Œ"}),r.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl\n                       hover:from-blue-700 hover:to-blue-800 transition-all duration-200\n                       disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium",children:c?r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})}),"ë“±ë¡ ì¤‘..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"ë“±ë¡í•˜ê¸°"]})})]})]})]})}):null}function d({onSelect:t,selectedCustomer:d,showAddButton:n=!0}){a();const[o,i]=e.useState([]),[c,x]=e.useState(!1),[m,u]=e.useState(""),[b,g]=e.useState(!1),[h,y]=e.useState(!1),p=e.useCallback(async()=>{try{g(!0);const e=await s(1,100,m);i(e.data)}catch(e){}finally{g(!1)}},[m]);e.useEffect(()=>{p()},[p]);return!b&&o.length,r.jsxs("div",{className:"relative",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"ê³ ê° ì„ íƒ:"}),d?r.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:[r.jsxs("span",{className:"text-blue-700 dark:text-blue-300",children:["ğŸ‘¤ ",d.name," (",d.birth_date,")"]}),r.jsx("button",{onClick:()=>{t(null),u("")},className:"text-red-500 hover:text-red-700",children:"âœ•"})]}):r.jsx("button",{onClick:()=>x(!c),className:"px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 \n                     rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:"ğŸ‘¤ ê³ ê° ì„ íƒí•˜ê¸°"})]}),c&&r.jsxs("div",{className:"absolute top-full mt-2 w-96 bg-white dark:bg-gray-800 rounded-lg shadow-xl \n                      border border-gray-200 dark:border-gray-700 z-50",children:[r.jsxs("div",{className:"p-4 space-y-3",children:[n&&r.jsx("button",{onClick:()=>{y(!0),x(!1)},className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg\n                         flex items-center justify-center gap-2 transition-colors",children:"â• ìƒˆ ê³ ê° ë“±ë¡"}),n&&r.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600"}),r.jsx("input",{type:"text",placeholder:"ì´ë¦„ ë˜ëŠ” ì „í™”ë²ˆí˜¸ë¡œ ê²€ìƒ‰...",value:m,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg\n                       bg-white dark:bg-gray-700 text-gray-900 dark:text-white",autoFocus:!0})]}),r.jsx("div",{className:"max-h-96 overflow-y-auto",children:b?r.jsx("div",{className:"p-4 text-center text-gray-500",children:"ë¡œë”© ì¤‘..."}):0===o.length?r.jsxs("div",{className:"p-6 text-center space-y-4",children:[r.jsx("div",{className:"text-4xl",children:"ğŸ”®"}),r.jsxs("div",{className:"text-gray-600 dark:text-gray-400",children:[r.jsx("p",{className:"font-medium mb-2",children:"ë“±ë¡ëœ ê³ ê°ì´ ì—†ìŠµë‹ˆë‹¤"}),r.jsxs("p",{className:"text-sm",children:['ìœ„ì˜ "ìƒˆ ê³ ê° ë“±ë¡" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬',r.jsx("br",{}),"ì²« ê³ ê°ì„ ë“±ë¡í•´ë³´ì„¸ìš”"]})]})]}):r.jsx("div",{className:"divide-y dark:divide-gray-700",children:o.map(e=>r.jsx("button",{onClick:()=>(e=>{t(e),x(!1),u("")})(e),className:"w-full px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700\n                             transition-colors text-left",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),r.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.birth_date," ",e.birth_time," Â·","lunar"===e.lunar_solar?"ìŒë ¥":"ì–‘ë ¥"," Â·","male"===e.gender?"ë‚¨":"ì—¬"]})]}),r.jsx("div",{className:"text-sm text-gray-400",children:e.phone})]})},e.id))})}),r.jsx("div",{className:"p-2 border-t dark:border-gray-700",children:r.jsx("button",{onClick:()=>x(!1),className:"w-full px-3 py-2 text-gray-600 dark:text-gray-400 \n                       hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:"ë‹«ê¸°"})})]}),r.jsx(l,{isOpen:h,onClose:()=>y(!1),onCustomerAdded:e=>{p(),t(e),y(!1)}})]})}export{d as C};
