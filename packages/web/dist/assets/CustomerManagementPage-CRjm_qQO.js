import{r as e,j as a}from"./react-vendor-BqNk2DgB.js";import{a as r,u as t,c as l,d as s}from"./customerApi-JV4xNEmH.js";import"./vendor-DgwlXjR1.js";import"./three-vendor-B4pyqsGd.js";import"./chart-vendor-DwU5C6A5.js";function d({embedded:d=!1}){const[n,x]=e.useState([]),[c,i]=e.useState(0),[m,o]=e.useState(1),[h,g]=e.useState(""),[y,b]=e.useState(!1),[u,p]=e.useState(null),[j,k]=e.useState(!1),[N,f]=e.useState({name:"",birth_date:"",birth_time:"",phone:"",lunar_solar:"solar",gender:"male",memo:""});e.useEffect(()=>{v()},[m,h]);const v=async()=>{try{k(!0);const e=await r(m,20,h);x(e.data),i(e.totalPages)}catch(e){alert("고객 목록을 불러오는데 실패했습니다")}finally{k(!1)}},w=()=>{f({name:"",birth_date:"",birth_time:"",phone:"",lunar_solar:"solar",gender:"male",memo:""})};return a.jsx("div",{className:d?"w-full":"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:a.jsxs("div",{className:d?"w-full":"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 "+(d?"border border-gray-200 dark:border-gray-600":""),children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:(d?"text-lg":"text-2xl")+" font-bold text-gray-900 dark:text-white",children:"🗂️ 고객 관리"}),a.jsx("button",{onClick:()=>{p(null),w(),b(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"➕ 새 고객 등록"})]}),a.jsx("div",{className:"mb-6",children:a.jsx("input",{type:"text",placeholder:"🔍 이름 또는 전화번호로 검색...",value:h,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg \n                       bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-gray-700 dark:text-gray-300",children:"번호"}),a.jsx("th",{className:"px-4 py-3 text-gray-700 dark:text-gray-300",children:"이름"}),a.jsx("th",{className:"px-4 py-3 text-gray-700 dark:text-gray-300",children:"생년월일"}),a.jsx("th",{className:"px-4 py-3 text-gray-700 dark:text-gray-300",children:"생시"}),a.jsx("th",{className:"px-4 py-3 text-gray-700 dark:text-gray-300",children:"전화번호"}),a.jsx("th",{className:"px-4 py-3 text-gray-700 dark:text-gray-300",children:"음/양"}),a.jsx("th",{className:"px-4 py-3 text-gray-700 dark:text-gray-300",children:"성별"}),a.jsx("th",{className:"px-4 py-3 text-gray-700 dark:text-gray-300",children:"관리"})]})}),a.jsx("tbody",{children:j?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"text-center py-8 text-gray-500",children:"로딩 중..."})}):0===n.length?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"text-center py-8 text-gray-500",children:"등록된 고객이 없습니다"})}):n.filter(e=>null!=e).map((e,r)=>a.jsxs("tr",{className:"border-b dark:border-gray-700",children:[a.jsx("td",{className:"px-4 py-3 text-gray-900 dark:text-white",children:20*(m-1)+r+1}),a.jsx("td",{className:"px-4 py-3 text-gray-900 dark:text-white font-medium",children:e.name}),a.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:e.birth_date}),a.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:e.birth_time}),a.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:e.phone}),a.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:"lunar"===e.lunar_solar?"음력":"양력"}),a.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:"male"===e.gender?"남":"여"}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("button",{onClick:()=>(e=>{p(e),f({name:e.name,birth_date:e.birth_date,birth_time:e.birth_time,phone:e.phone,lunar_solar:e.lunar_solar,gender:e.gender,memo:e.memo||""}),b(!0)})(e),className:"text-blue-600 hover:text-blue-800 mr-3",children:"✏️"}),a.jsx("button",{onClick:()=>(async e=>{if(confirm("정말 삭제하시겠습니까?"))try{await s(e),alert("고객이 삭제되었습니다"),v()}catch(a){alert(a.message||"삭제 중 오류가 발생했습니다")}})(e.id),className:"text-red-600 hover:text-red-800",children:"🗑️"})]})]},e.id))})]})}),c>1&&a.jsxs("div",{className:"flex justify-center mt-6 space-x-2",children:[a.jsx("button",{onClick:()=>o(e=>Math.max(1,e-1)),disabled:1===m,className:"px-3 py-1 border rounded disabled:opacity-50",children:"◀"}),[...Array(c)].map((e,r)=>a.jsx("button",{onClick:()=>o(r+1),className:"px-3 py-1 border rounded "+(m===r+1?"bg-blue-600 text-white":"hover:bg-gray-100 dark:hover:bg-gray-700"),children:r+1},r)),a.jsx("button",{onClick:()=>o(e=>Math.min(c,e+1)),disabled:m===c,className:"px-3 py-1 border rounded disabled:opacity-50",children:"▶"})]})]}),y&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-xl font-bold mb-6 text-gray-900 dark:text-white",children:u?"고객 정보 수정":"새 고객 등록"}),a.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{u?(await t(u.id,N),alert("고객 정보가 수정되었습니다")):(await l(N),alert("고객이 등록되었습니다")),b(!1),p(null),w(),v()}catch(a){alert(a.message||"저장 중 오류가 발생했습니다")}},children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"이름 *"}),a.jsx("input",{type:"text",required:!0,value:N.name,onChange:e=>f({...N,name:e.target.value}),className:"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"생년월일 *"}),a.jsx("input",{type:"date",required:!0,value:N.birth_date,onChange:e=>f({...N,birth_date:e.target.value}),className:"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"생시 * (24시간 형식)"}),a.jsx("input",{type:"time",required:!0,value:N.birth_time,onChange:e=>f({...N,birth_time:e.target.value}),className:"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"전화번호 *"}),a.jsx("input",{type:"tel",required:!0,placeholder:"010-1234-5678",value:N.phone,onChange:e=>f({...N,phone:e.target.value}),className:"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"음력/양력"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"solar",checked:"solar"===N.lunar_solar,onChange:e=>f({...N,lunar_solar:"solar"}),className:"mr-2"}),"양력"]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"lunar",checked:"lunar"===N.lunar_solar,onChange:e=>f({...N,lunar_solar:"lunar"}),className:"mr-2"}),"음력"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"성별 *"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"male",checked:"male"===N.gender,onChange:e=>f({...N,gender:"male"}),className:"mr-2"}),"남"]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"female",checked:"female"===N.gender,onChange:e=>f({...N,gender:"female"}),className:"mr-2"}),"여"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"메모"}),a.jsx("textarea",{value:N.memo,onChange:e=>f({...N,memo:e.target.value}),rows:3,className:"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{type:"button",onClick:()=>{b(!1),p(null)},className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",children:"취소"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:u?"수정하기":"등록하기"})]})]})]})})]})})}export{d as default};
