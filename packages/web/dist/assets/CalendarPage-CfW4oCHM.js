import{r as e,j as t,b as r,e as a}from"./react-vendor-BqNk2DgB.js";import{d as s,a as l,u as n,b as o,e as i}from"./index-DlHBBt9Z.js";import{b as d,c,s as x,e as m,f as u,g,h,j as b,k as p,a as y,l as f,m as v,i as j,n as N,o as k}from"./calendar-vendor-Bhba01pF.js";import{aP as w,aQ as C,aR as M,aS as D,ap as S,aq as E,aT as L,aU as $,aV as T,aW as _,aX as O}from"./vendor-DgwlXjR1.js";import{u as F}from"./sajuSettingsStore-Btb3FM7R.js";import{e as I,g as P,a as H,E as B}from"./EventModal-CDYvrtk5.js";import{g as z}from"./lunarCalendar-BkOe8G-7.js";import"./chart-vendor-DwU5C6A5.js";import"./document-vendor-kJlPqfgG.js";import"./three-vendor-B4pyqsGd.js";import"./qimenCalculator-Dgq1wFxg.js";const A=({viewMode:t,currentDate:r})=>{const[a,l]=e.useState({diaries:[],diaryDates:new Set,loading:!1,error:null}),n=e.useCallback(()=>{let e,a;switch(t){case"year":e=new Date(r.getFullYear(),0,1),a=new Date(r.getFullYear(),11,31);break;case"month":default:e=d(r),a=c(r);break;case"week":e=x(r,{weekStartsOn:0}),a=m(r,{weekStartsOn:0});break;case"day":e=r,a=r}return{startDate:u(e,"yyyy-MM-dd"),endDate:u(a,"yyyy-MM-dd")}},[t,r]),o=e.useCallback(async()=>{l(e=>({...e,loading:!0,error:null}));try{const{startDate:e,endDate:t}=n(),r=await s.getDiariesForDateRange(e,t),a=new Set;r.forEach(e=>{e.date&&(e.content&&e.content.trim()||e.images&&e.images.length>0)&&a.add(e.date)}),l({diaries:r,diaryDates:a,loading:!1,error:null})}catch(e){l(e=>({...e,loading:!1,error:"Failed to load diary entries"}))}},[n]),i=e.useCallback(e=>{const t="string"==typeof e?e:u(e,"yyyy-MM-dd");return a.diaryDates.has(t)},[a.diaryDates]),g=e.useCallback(e=>{const t="string"==typeof e?e:u(e,"yyyy-MM-dd");return a.diaries.find(e=>e.date===t)},[a.diaries]);return e.useEffect(()=>{o()},[o]),{diaries:a.diaries,diaryDates:a.diaryDates,loading:a.loading,error:a.error,hasDiary:i,getDiaryForDate:g,reloadDiaries:o}},R={reflection:["오늘 하루 가장 감사했던 순간은 언제였나요?","마음 깊은 곳의 진짜 기분을 솔직하게 적어보세요.","오늘 나에게 가장 소중했던 것은 무엇인가요?","하루를 돌아보며, 나는 어떤 사람이었는지 생각해보세요.","오늘의 나에게 전하고 싶은 한 마디가 있다면?","마음속 깊은 곳의 목소리에 귀 기울여보세요.","오늘 나를 가장 행복하게 만든 순간을 기억해보세요.","지금 이 순간 내 마음은 어떤 색깔인가요?","오늘 하루 나는 누구를 위해 살았나요?","마음이 가장 평화로웠던 시간을 떠올려보세요.","오늘의 나에게 칭찬해주고 싶은 점이 있다면?","하루 종일 가슴 한편에 머물렀던 생각을 적어보세요.","오늘 나는 어떤 마음으로 사람들을 만났나요?","지금 이 순간 내가 가장 그리운 것은 무엇인가요?","오늘의 경험 중 마음에 가장 깊이 새겨두고 싶은 것은?"],emotion:["때로는 슬픔도 소중한 감정입니다. 있는 그대로 받아들여보세요.","웃었던 순간들을 기억해보세요. 그 따뜻함을 글로 남겨보세요.","기쁨이든 슬픔이든, 지금 이 감정도 소중한 나의 일부입니다.","마음이 무거울 때일수록, 작은 행복을 찾아보세요.","감정을 억누르지 말고, 종이 위에 자유롭게 풀어놓으세요.","오늘의 감정들이 내일의 나를 더 단단하게 만들어줄 거예요.","눈물이 나더라도 괜찮아요. 그것도 마음을 정화하는 방법입니다.","행복했던 순간을 글로 적으면서 그 기분을 다시 느껴보세요.","마음속 감정들을 색깔로 표현한다면 어떤 색일까요?","오늘 느낀 모든 감정들에게 고마움을 전해보세요.","감정의 파도가 지나가는 것을 지켜보며 기록해보세요.","내 마음의 날씨는 지금 어떤가요? 맑음? 흐림? 비?","감정도 계절처럼 변한다는 걸 기억하세요.","오늘의 감정을 한 줄로 요약한다면?","마음이 시키는 대로 자유롭게 써보세요."],relationship:["오늘 만난 사람들 중 누구에게 고마움을 느꼈나요?","가족이나 친구에게 하고 싶었던 말을 적어보세요.","오늘 누군가에게 따뜻함을 전했던 순간이 있나요?","소중한 사람과의 대화 중 기억에 남는 말이 있다면?","오늘 누군가의 미소가 나를 행복하게 만들었나요?","마음을 나누고 싶은 사람이 지금 생각나시나요?","오늘 받은 작은 친절이나 배려를 기록해보세요.","누군가에게 미안한 마음이 있다면 솔직하게 적어보세요.","오늘 내가 누군가에게 도움이 되었던 순간이 있나요?","가장 그리운 사람에게 편지를 쓴다면?","오늘의 만남들이 내게 준 의미를 생각해보세요.","혼자였지만 외롭지 않았던 순간, 함께였지만 외로웠던 순간은?","오늘 누군가의 마음을 이해할 수 있었던 순간이 있나요?","내가 사랑하는 사람들의 얼굴을 떠올리며 써보세요.","오늘 새로운 인연이나 깊어진 관계가 있었나요?"],growth:["오늘 새롭게 배운 것이나 깨달은 점이 있다면 기록해보세요.","어제보다 조금이라도 나아진 모습을 찾아보세요.","오늘 나의 한계를 뛰어넘으려 노력했던 순간이 있나요?","실수나 실패에서도 배울 점을 찾아보세요.","미래의 나에게 지금의 경험이 어떤 도움이 될까요?","오늘의 도전이 내일의 성장으로 이어질 거예요.","작은 변화라도 그것이 시작이라는 걸 기억하세요.","오늘 내가 용기를 냈던 순간을 기록해보세요.","어려운 상황에서도 포기하지 않은 나를 칭찬해주세요.","오늘의 경험이 나를 더 지혜롭게 만들었나요?","새로운 시각으로 바라본 것들이 있다면?","오늘 내가 한 선택들을 돌아보며 배운 점은?","힘들었지만 끝까지 해낸 일이 있나요?","오늘의 나를 어제의 나와 비교해보세요.","성장하고 있는 나 자신을 믿어보세요."],gratitude:["오늘 가장 감사한 세 가지를 적어보세요.","작은 일상 속에서 찾은 행복을 기록해보세요.","나를 위해 힘써준 사람들을 떠올리며 감사 인사를 써보세요.","오늘 내가 누릴 수 있었던 것들에 감사해보세요.","건강한 하루를 보낼 수 있어서 감사하다는 마음을 적어보세요.","따뜻한 잠자리, 맛있는 음식... 당연한 것들에 감사해보세요.","오늘 나를 웃게 만든 것들을 나열해보세요.","사계절의 변화, 자연의 아름다움에 감사한 마음을 써보세요.","가족, 친구들의 존재에 대한 감사함을 표현해보세요.","오늘 하루 무사히 보낼 수 있어서 감사합니다.","내가 가진 작은 재능이나 능력에 감사해보세요.","어려움 속에서도 나를 지켜준 것들을 생각해보세요.","오늘의 모든 순간들이 선물이었다고 생각해보세요.","나를 사랑해주는 사람들이 있어서 감사합니다.","지금 이 순간, 글을 쓸 수 있어서 감사합니다."]};function W(e){const t=1e4*Math.sin(e);return t-Math.floor(t)}function Q(e){const t=function(e){return 1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate()}(e),r=Object.keys(R),a=r[Math.floor(W(t)*r.length)],s=R[a];return{advice:s[Math.floor(W(t+1)*s.length)],category:a}}function U(e){return{reflection:"🤔",emotion:"💝",relationship:"👥",growth:"🌱",gratitude:"🙏"}[e]}function Y(e){return{reflection:"#8B5CF6",emotion:"#EC4899",relationship:"#3B82F6",growth:"#10B981",gratitude:"#F59E0B"}[e]}function K({images:r,currentIndex:a,isOpen:s,onClose:l,onNext:n,onPrev:o}){const[i,d]=e.useState(a),[c,x]=e.useState(!0);e.useEffect(()=>{d(a)},[a]),e.useEffect(()=>{if(!s)return;const e=e=>{"Escape"===e.key?l():"ArrowLeft"===e.key?u():"ArrowRight"===e.key&&m()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s,i,r.length]);const m=()=>{if(r.length<=1)return;const e=(i+1)%r.length;d(e),x(!0),null==n||n()},u=()=>{if(r.length<=1)return;const e=(i-1+r.length)%r.length;d(e),x(!0),null==o||o()};return s&&r&&0!==r.length?t.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center",onClick:l,children:[t.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 flex items-center justify-between bg-gradient-to-b from-black/50 to-transparent",children:[t.jsxs("div",{className:"text-white text-sm font-medium",children:[i+1," / ",r.length]}),t.jsx("button",{onClick:l,className:"p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors backdrop-blur-sm","aria-label":"닫기",children:t.jsx(w,{className:"w-6 h-6 text-white"})})]}),t.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] flex items-center justify-center",onClick:e=>e.stopPropagation(),children:[c&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"w-12 h-12 border-4 border-white/20 border-t-white rounded-full animate-spin"})}),t.jsx("img",{src:r[i],alt:`이미지 ${i+1}`,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl",onLoad:()=>{x(!1)},style:{display:c?"none":"block"}}),r.length>1&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:e=>{e.stopPropagation(),u()},className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 rounded-full bg-white/10 hover:bg-white/20 transition-all backdrop-blur-sm group","aria-label":"이전 이미지",children:t.jsx(C,{className:"w-6 h-6 text-white group-hover:scale-110 transition-transform"})}),t.jsx("button",{onClick:e=>{e.stopPropagation(),m()},className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 rounded-full bg-white/10 hover:bg-white/20 transition-all backdrop-blur-sm group","aria-label":"다음 이미지",children:t.jsx(M,{className:"w-6 h-6 text-white group-hover:scale-110 transition-transform"})})]})]}),r.length>1&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/50 to-transparent",children:t.jsx("div",{className:"flex items-center justify-center gap-2 overflow-x-auto max-w-full",children:r.map((e,r)=>t.jsx("button",{onClick:e=>{e.stopPropagation(),d(r),x(!0)},className:`\n                  relative w-16 h-16 rounded-lg overflow-hidden border-2 transition-all flex-shrink-0\n                  ${r===i?"border-white scale-110 shadow-xl":"border-white/30 hover:border-white/60 hover:scale-105"}\n                `,children:t.jsx("img",{src:e,alt:`썸네일 ${r+1}`,className:"w-full h-full object-cover"})},r))})}),t.jsxs("div",{className:"absolute bottom-4 left-4 text-white/60 text-xs",children:[t.jsx("div",{children:"ESC: 닫기"}),t.jsx("div",{children:"← →: 이미지 이동"})]})]}):null}const q=[{emoji:"😊",label:"기분 좋음"},{emoji:"😐",label:"보통"},{emoji:"😢",label:"슬픔"},{emoji:"😠",label:"화남"},{emoji:"😴",label:"피곤함"},{emoji:"🤔",label:"고민"},{emoji:"😍",label:"설렘"},{emoji:"😱",label:"놀람"}];function J({isOpen:r,onClose:a,date:l,onSave:n}){const[o,i]=e.useState(l),[d,c]=e.useState(""),[x,m]=e.useState("😊"),[y,f]=e.useState(!1),[v,j]=e.useState(null),[N,k]=e.useState(null),[C,M]=e.useState(!1),[S,E]=e.useState(0),[L,$]=e.useState([]),[T,_]=e.useState(!1),[O,F]=e.useState(!1),[I,P]=e.useState(0),H=Q(o),B=Q(g(o)),z=g(o),A=e.useCallback(async e=>{var t,r;f(!0);try{const l=u(e,"yyyy-MM-dd"),n=u(g(e,1),"yyyy-MM-dd");try{const e=await s.getDiaryByDate(l);j(e),c(e.content||""),m(e.mood||"😊"),$(e.images||[])}catch(a){404===(null==(t=a.response)?void 0:t.status)&&j(null)}try{const e=await s.getDiaryByDate(n);k(e)}catch(a){404===(null==(r=a.response)?void 0:r.status)&&k(null)}}catch(a){}finally{f(!1)}},[]),R=e.useCallback(async()=>{if(d.trim()){M(!0);try{const e={date:u(o,"yyyy-MM-dd"),content:d.trim(),mood:x,weather:void 0,images:L.length>0?L:void 0,tags:[]};if(null==v?void 0:v.id)await s.updateDiary(v.id,e);else{const t=await s.createDiary(e);j(t)}}catch(e){}finally{M(!1)}}},[d,o,x,L,v]);e.useEffect(()=>{r&&(i(l),A(l))},[r,l,A]),e.useEffect(()=>{r&&o&&A(o)},[o,r,A]),e.useEffect(()=>{if(!d.trim()||!v)return;const e=setTimeout(()=>{d===(null==v?void 0:v.content)&&x===(null==v?void 0:v.mood)&&JSON.stringify(L)===JSON.stringify((null==v?void 0:v.images)||[])||R()},3e3);return()=>clearTimeout(e)},[d,x,L,v,R]),e.useEffect(()=>{E(d.length)},[d]),e.useEffect(()=>{if(v){JSON.stringify(L)!==JSON.stringify(v.images||[])&&$(v.images||[])}else L.length>0&&$([])},[v,L]);const W=async()=>{var e,t,r;if(d.trim()){f(!0);try{const e=u(o,"yyyy-MM-dd");let t;L.length>0&&(t=L);const r={date:e,content:d.trim(),mood:x,weather:void 0,images:t,tags:[]};let a;a=(null==v?void 0:v.id)?await s.updateDiary(v.id,r):await s.createDiary(r),j(a),n&&n(a),alert("일기가 저장되었습니다!")}catch(a){let s="일기 저장에 실패했습니다.";413===(null==(e=null==a?void 0:a.response)?void 0:e.status)?s="이미지 크기가 너무 큽니다. 더 작은 이미지를 선택해주세요.":500===(null==(t=null==a?void 0:a.response)?void 0:t.status)?s="서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요.":404===(null==(r=null==a?void 0:a.response)?void 0:r.status)?s="다이어리 서비스에 연결할 수 없습니다.":(null==a?void 0:a.message)&&(s=`저장 실패: ${a.message}`),alert(s)}finally{f(!1)}}},J=()=>{i(g(o))},G=()=>{i(b(o,1))},V=async e=>new Promise(t=>{const r=document.createElement("canvas"),a=r.getContext("2d"),s=new Image;s.onload=()=>{let{width:l,height:n}=s;const o=e.size/1048576;let i=1920,d=1920,c=.85;o>20?(i=1200,d=1200,c=.7):o>10?(i=1600,d=1600,c=.75):o>5&&(i=1920,d=1920,c=.8);const x=Math.min(i/l,d/n);x<1&&(l=Math.floor(l*x),n=Math.floor(n*x)),r.width=l,r.height=n,a.imageSmoothingEnabled=!0,a.imageSmoothingQuality="high",a.drawImage(s,0,0,l,n);const m=document.createElement("canvas");m.width=m.height=1;m.getContext("2d").fillRect(0,0,1,1);const u=m.toDataURL("image/webp").startsWith("data:image/webp");let g;g=u?r.toDataURL("image/webp",c):r.toDataURL("image/jpeg",c);if(3*g.length/4/1048576>2&&c>.5){const e=Math.max(.5,.8*c);g=r.toDataURL(u?"image/webp":"image/jpeg",e)}t(g)},s.src=URL.createObjectURL(e)});return r?t.jsxs("div",{className:"fixed inset-0 z-50 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4",onClick:a,onKeyDown:e=>{"ArrowLeft"===e.key&&e.ctrlKey?J():"ArrowRight"===e.key&&e.ctrlKey?G():"Escape"===e.key?a():"s"===e.key&&e.ctrlKey&&(e.preventDefault(),W())},tabIndex:-1,children:[t.jsxs("div",{className:"diary-book-container relative max-w-6xl w-full max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-900/20 to-gray-700/40 dark:from-slate-900/40 dark:to-slate-700/60 rounded-2xl transform rotate-1 scale-105"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-800/30 to-gray-600/50 dark:from-slate-800/50 dark:to-slate-600/70 rounded-2xl transform -rotate-1 scale-102"}),t.jsxs("div",{className:"relative bg-gradient-to-b from-amber-50 to-amber-100 dark:from-slate-800 dark:to-slate-900 rounded-2xl shadow-2xl border-2 border-amber-200 dark:border-slate-700 p-8",children:[t.jsxs("div",{className:"flex justify-between items-start mb-6",children:[t.jsx("div",{className:"text-sm font-medium text-amber-700 dark:text-gray-400",children:u(o,"yyyy년 M월",{locale:p})}),t.jsxs("div",{className:"flex-1 text-center",children:[t.jsx("h1",{className:"text-2xl font-light text-amber-800 dark:text-gray-200 tracking-wide",style:{fontFamily:"Georgia, serif"},children:"하루의 여백"}),t.jsx("div",{className:"w-20 h-0.5 bg-gradient-to-r from-amber-400 to-amber-600 dark:from-purple-500 dark:to-indigo-500 mx-auto mt-2 rounded-full"})]}),t.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:"✕"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-8 min-h-[500px]",children:[t.jsxs("div",{className:"diary-page relative",children:[t.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-red-300 dark:bg-slate-600 rounded-full"}),t.jsxs("div",{className:"pl-6",children:[t.jsxs("div",{className:"border-b-2 border-dashed border-amber-300 dark:border-slate-600 pb-3 mb-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold text-amber-700 dark:text-gray-300",children:u(z,"M월 d일",{locale:p})}),t.jsx("p",{className:"text-sm text-amber-600 dark:text-gray-400",children:u(z,"EEEE",{locale:p})})]}),(null==N?void 0:N.mood)&&t.jsx("span",{className:"text-2xl",children:N.mood})]}),t.jsx("div",{className:"mt-3 p-2 bg-amber-100/50 dark:bg-slate-700/30 rounded-lg border border-amber-200 dark:border-slate-600",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[t.jsx("span",{className:"text-amber-600 dark:text-gray-400",children:U(B.category)}),t.jsx("span",{className:"text-amber-700 dark:text-gray-300 leading-relaxed",children:B.advice})]})})]}),t.jsx("div",{className:"diary-content",children:N?t.jsxs("div",{className:"space-y-3",children:[t.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed whitespace-pre-wrap text-sm",style:{fontFamily:"Georgia, serif"},children:N.content}),t.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[N.content.length,"자"]})]}):t.jsxs("div",{className:"text-center text-gray-400 dark:text-gray-500 italic py-8",children:[t.jsx("p",{className:"text-sm",children:"어제의 일기가 없습니다"}),t.jsx("span",{className:"text-2xl",children:"📝"})]})})]})]}),t.jsx("div",{className:"hidden lg:block absolute left-1/2 top-16 bottom-16 w-px bg-gradient-to-b from-amber-300 via-amber-400 to-amber-300 dark:from-transparent dark:via-slate-500 dark:to-transparent"}),t.jsxs("div",{className:"diary-page relative",children:[t.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 bg-red-300 dark:bg-slate-600 rounded-full"}),t.jsxs("div",{className:"pr-6",children:[t.jsxs("div",{className:"border-b-2 border-dashed border-amber-300 dark:border-slate-600 pb-3 mb-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold text-amber-700 dark:text-gray-300",children:u(o,"M월 d일",{locale:p})}),t.jsx("p",{className:"text-sm text-amber-600 dark:text-gray-400",children:u(o,"EEEE",{locale:p})})]}),t.jsx("div",{className:"flex gap-1",children:q.slice(0,4).map(({emoji:e})=>{var r;return t.jsx("button",{onClick:()=>m(e),className:"text-xl p-1 rounded transition-all hover:scale-110 "+(x===e?"bg-amber-200 dark:bg-slate-700 shadow-sm":"hover:bg-amber-100 dark:hover:bg-slate-800"),title:null==(r=q.find(t=>t.emoji===e))?void 0:r.label,children:e},e)})})]}),t.jsx("div",{className:"mt-3 p-3 rounded-lg border-2 border-dashed shadow-sm",style:{backgroundColor:`${Y(H.category)}15`,borderColor:`${Y(H.category)}40`},children:t.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[t.jsx("span",{className:"text-base mt-1",style:{color:Y(H.category)},children:U(H.category)}),t.jsx("span",{className:"leading-relaxed font-medium",style:{color:Y(H.category)},children:H.advice})]})})]}),t.jsxs("div",{className:"diary-content",children:[t.jsx("textarea",{value:d,onChange:e=>c(e.target.value),placeholder:"오늘 하루는 어땠나요? 마음속 이야기를 자유롭게 적어보세요...",className:"w-full h-64 p-0 border-none bg-transparent resize-none focus:outline-none text-gray-700 dark:text-gray-300 placeholder-amber-400 dark:placeholder-gray-500 leading-relaxed",style:{fontFamily:"Georgia, serif",fontSize:"14px",lineHeight:"24px",background:"repeating-linear-gradient(\n                        transparent,\n                        transparent 23px,\n                        rgba(251, 191, 36, 0.2) 23px,\n                        rgba(251, 191, 36, 0.2) 24px\n                      )"}}),t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 \n                                       bg-slate-100 dark:bg-slate-700 \n                                       hover:bg-slate-200 dark:hover:bg-slate-600 \n                                       rounded-lg cursor-pointer transition-colors w-fit\n                                       "+(T?"opacity-50 cursor-not-allowed":""),children:[t.jsx(D,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:T?"압축 중...":"사진 추가"}),t.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:async e=>{const t=e.target.files;if(t&&0!==t.length)if(L.length+t.length>3)alert("최대 3장까지 업로드 가능합니다");else{_(!0);try{const e=[];for(const r of Array.from(t)){if(!r.type.startsWith("image/")){alert("이미지 파일만 업로드 가능합니다");continue}if(r.size>52428800){alert("파일 크기는 50MB 이하만 가능합니다");continue}const t=await V(r);t.length;e.push(t)}$(t=>[...t,...e])}catch(r){alert("이미지 업로드 중 오류가 발생했습니다")}finally{_(!1),e.target.value=""}}},disabled:T})]}),t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"최대 3장 • 자동 WebP 압축 • 50MB 이하"})]}),L.length>0&&t.jsx("div",{className:"grid grid-cols-3 gap-2 mt-3",children:L.map((e,r)=>t.jsxs("div",{className:"relative group",children:[t.jsx("img",{src:e,className:"w-full h-20 object-cover rounded-lg cursor-pointer hover:opacity-80 transition-opacity",alt:`업로드된 이미지 ${r+1}`,onClick:()=>{P(r),F(!0)}}),t.jsx("button",{onClick:()=>{return e=r,void $(t=>t.filter((t,r)=>r!==e));var e},className:"absolute top-1 right-1 \n                                         bg-red-500 hover:bg-red-600 text-white \n                                         rounded-full w-5 h-5 flex items-center justify-center\n                                         opacity-0 group-hover:opacity-100 \n                                         transition-opacity text-xs font-bold",children:t.jsx(w,{className:"w-3 h-3"})})]},r))}),T&&t.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-gray-500",children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-500"}),t.jsx("span",{children:"이미지 업로드 중..."})]})]}),t.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500 mt-2",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{children:[S,"자"]}),C&&t.jsx("span",{className:"text-blue-500 animate-pulse",children:"자동 저장 중..."})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-amber-500",children:"✨"}),t.jsx("span",{children:"일기장"})]})]})]})]})]})]}),t.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t border-amber-200 dark:border-slate-700",children:[t.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-4 py-2 text-amber-700 dark:text-gray-300 hover:bg-amber-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:[t.jsx("span",{className:"text-lg",children:"◀"}),t.jsx("span",{className:"text-sm font-medium",children:"어제"})]}),t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[!h(o)&&t.jsx("button",{onClick:()=>i(new Date),className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium transition-colors",children:"오늘"}),t.jsx("div",{className:"text-xs text-amber-600 dark:text-gray-500",children:"Ctrl + ← → 로 페이지 이동"})]}),t.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-4 py-2 text-amber-700 dark:text-gray-300 hover:bg-amber-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:[t.jsx("span",{className:"text-sm font-medium",children:"내일"}),t.jsx("span",{className:"text-lg",children:"▶"})]})]}),t.jsx("div",{className:"flex justify-end items-center mt-4",children:t.jsx("div",{className:"flex gap-2",children:t.jsx("button",{onClick:W,disabled:!d.trim()||y,className:`\n                  px-6 py-2 rounded-lg font-medium transition-colors\n                  ${d.trim()&&!y?"bg-amber-500 hover:bg-amber-600 text-white shadow-sm":"bg-gray-300 dark:bg-gray-600 text-gray-500 cursor-not-allowed"}\n                `,children:y?"저장 중...":"저장하기 "+(d.length>0?`(${d.length}자)`:"")})})})]})]}),t.jsx(K,{images:L,currentIndex:I,isOpen:O,onClose:()=>F(!1)})]}):null}function G({isOpen:r,onClose:a,todo:s}){const{updateTodo:n}=l(),[o,i]=e.useState(""),[d,c]=e.useState("medium"),[x,m]=e.useState(!1),[u,g]=e.useState("");e.useEffect(()=>{s&&(i(s.text),c(s.priority),m(s.hasTime||!1),g(s.startTime||""))},[s]);return r&&s?t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),t.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"할일 수정"}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),s&&o.trim()&&(n(s.id,{text:o.trim(),priority:d,hasTime:x,startTime:x?u:void 0}),a())},className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"할일 내용"}),t.jsx("input",{type:"text",value:o,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700",placeholder:"할일을 입력하세요",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"우선순위"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{type:"button",onClick:()=>c("high"),className:"flex-1 py-2 px-3 rounded-md "+("high"===d?"bg-red-500 text-white":"bg-gray-200 dark:bg-gray-700"),children:"🔴 높음"}),t.jsx("button",{type:"button",onClick:()=>c("medium"),className:"flex-1 py-2 px-3 rounded-md "+("medium"===d?"bg-yellow-500 text-white":"bg-gray-200 dark:bg-gray-700"),children:"🟡 보통"}),t.jsx("button",{type:"button",onClick:()=>c("low"),className:"flex-1 py-2 px-3 rounded-md "+("low"===d?"bg-green-500 text-white":"bg-gray-200 dark:bg-gray-700"),children:"🟢 낮음"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:x,onChange:e=>m(e.target.checked),className:"mr-2"}),t.jsx("span",{className:"text-sm font-medium",children:"시간 지정"})]}),x&&t.jsx("input",{type:"time",value:u,onChange:e=>g(e.target.value),className:"mt-2 w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"})]}),t.jsxs("div",{className:"flex gap-2 pt-4",children:[t.jsx("button",{type:"submit",className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",children:"수정"}),t.jsx("button",{type:"button",onClick:a,className:"flex-1 py-2 px-4 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors",children:"취소"})]})]})]})]})}):null}function V({pattern:e="clouds",opacity:r=.1,className:a=""}){return t.jsx("div",{className:`absolute inset-0 overflow-hidden pointer-events-none ${a}`,children:t.jsxs("svg",{className:"w-full h-full",style:{opacity:r},viewBox:"0 0 40 30",preserveAspectRatio:"xMidYMid slice",children:[t.jsx("defs",{children:t.jsx("pattern",{id:e,x:"0",y:"0",width:"40",height:"30",patternUnits:"userSpaceOnUse",children:t.jsx("path",{d:{clouds:"M10,20 Q15,10 20,20 Q25,10 30,20 Q35,10 40,20",waves:"M0,15 Q5,5 10,15 Q15,25 20,15 Q25,5 30,15 Q35,25 40,15",mountains:"M0,25 L5,15 L10,20 L15,10 L20,20 L25,15 L30,25 L35,10 L40,25",bamboo:"M10,5 L10,25 M15,8 L15,25 M20,5 L20,25"}[e],fill:"none",stroke:"currentColor",strokeWidth:"0.5",className:"text-gray-400 dark:text-gray-600"})})}),t.jsx("rect",{width:"100%",height:"100%",fill:`url(#${e})`})]})})}const X=["갑","을","병","정","무","기","경","신","임","계"],Z={"갑":"목","을":"목","병":"화","정":"화","무":"토","기":"토","경":"금","신":"금","임":"수","계":"수","인":"목","묘":"목","사":"화","오":"화","진":"토","술":"토","축":"토","미":"토","유":"금","자":"수","해":"수"},ee={"목":"화","화":"토","토":"금","금":"수","수":"목"},te={"목":"토","화":"금","토":"수","금":"목","수":"화"},re={level:"excellent",label:"대길",color:"#10b981",icon:"🌟"},ae={level:"good",label:"길함",color:"#22c55e",icon:"✨"},se={level:"normal",label:"보통",color:"#f59e0b",icon:"⭐"},le={level:"caution",label:"주의",color:"#f97316",icon:"⚠️"},ne={level:"bad",label:"흉함",color:"#ef4444",icon:"🚨"},oe=["#4f46e5","#059669","#dc2626","#7c3aed","#ea580c","#0891b2"],ie=[1,3,5,7,9,11,13,17,19,21,23,29];function de(e){return e>=85?re:e>=70?ae:e>=50?se:e>=30?le:ne}function ce(e,t,r){const a={excellent:["오늘은 모든 일이 순조롭게 풀리는 대길한 날입니다. 새로운 도전을 시작하기에 좋습니다.","행운의 기운이 가득한 하루입니다. 중요한 결정을 내리기에 최적의 시기입니다.","긍정적인 에너지가 충만한 날입니다. 주변 사람들과의 관계도 더욱 좋아질 것입니다."],good:["전반적으로 좋은 흐름을 타는 하루입니다. 계획했던 일들을 추진해보세요.","운세가 상승하는 시기입니다. 적극적인 자세로 임하면 좋은 결과가 있을 것입니다.","안정적이고 평화로운 하루가 될 것입니다. 차분한 마음으로 일을 처리하세요."],normal:["무난한 하루가 예상됩니다. 평소보다 신중하게 행동하는 것이 좋겠습니다.","큰 변화보다는 현재 상황을 유지하는 것이 바람직한 시기입니다.","조급해하지 말고 차근차근 진행하면 좋은 결과를 얻을 수 있습니다."],caution:["조심스럽게 행동하는 것이 필요한 하루입니다. 성급한 판단은 피하세요.","작은 일도 꼼꼼히 확인하고 진행하는 것이 좋겠습니다.","어려움이 있더라도 포기하지 말고 꾸준히 노력하세요."],bad:["오늘은 새로운 일을 시작하기보다는 기존 일을 정리하는 것이 좋겠습니다.","주변 사람들과의 갈등을 피하고 조화를 이루도록 노력하세요.","힘든 시기이지만 이또한 지나갈 것입니다. 긍정적인 마음을 유지하세요."]}[de(e).level];return a[Math.floor(Math.random()*a.length)]}function xe(e,t=new Date){const r=function(e){const t=(e.year-4)%10;return Z[X[t]]||"목"}(e),a=function(e){const t=new Date(1900,0,1),r=Math.floor((e.getTime()-t.getTime())/864e5);return X[(r+36)%60%10]}(t),s=Z[a]||"목",l=function(e,t){return e===t?75:ee[e]===t?85:ee[t]===e?90:te[e]===t?45:te[t]===e?35:60}(r,s),n=t.getDate(),o=t.getMonth()+1,i=t.getFullYear(),d=(e.year+e.month+e.day+e.hour)%100,c=Math.min(100,Math.max(0,l+(n+d)%31-15)),x=Math.min(100,Math.max(0,l+(o+d)%31-15)),m=Math.min(100,Math.max(0,l+(i+d)%31-15)),g=Math.min(100,Math.max(0,l+(n*o+d)%31-15)),h=Math.min(100,Math.max(0,l+(n+o+d)%31-15)),b=Math.min(100,Math.max(0,l+(i+n+d)%31-15)),p=(n+d)%oe.length,y=(o+d)%ie.length;return{date:u(t,"yyyy-MM-dd"),totalLuck:c,loveLuck:x,wealthLuck:m,healthLuck:g,careerLuck:h,studyLuck:b,message:ce(c),luckyColor:oe[p],luckyNumber:ie[y],advice:`오늘의 기운: ${r}행이 ${s}행과 만나는 날입니다.`}}function me(e){return de(e)}const ue=S()(E((e,t)=>({dailyFortune:null,lastCalculatedDate:null,lastBirthInfo:null,calculateFortune:(r,a)=>{const s=t(),l=(e=>e.toISOString().split("T")[0])(a);if(s.lastCalculatedDate===l&&(n=s.lastBirthInfo,o=r,n&&o&&n.year===o.year&&n.month===o.month&&n.day===o.day&&n.hour===o.hour&&n.minute===o.minute&&n.isLunar===o.isLunar&&n.gender===o.gender)&&s.dailyFortune)return s.dailyFortune;var n,o;try{const t=xe(r,a);return e({dailyFortune:t,lastCalculatedDate:l,lastBirthInfo:r}),t}catch(i){return null}},clearCache:()=>{e({dailyFortune:null,lastCalculatedDate:null,lastBirthInfo:null})}}),{name:"fortune-storage",partialize:e=>({dailyFortune:e.dailyFortune,lastCalculatedDate:e.lastCalculatedDate,lastBirthInfo:e.lastBirthInfo})})),ge=({date:r,compact:a=!1})=>{const{birthInfo:s}=F(),{calculateFortune:l}=ue(),n=e.useMemo(()=>s?l(s,r):null,[s,r,l]);if(!n||!s)return null;const o=me(n.totalLuck);return a?t.jsxs("div",{className:"absolute bottom-1 right-1 flex items-center gap-0.5",children:[t.jsx("span",{className:"text-xs",title:`오늘의 운세: ${o.label} (${Math.round(n.totalLuck)}%)`,children:n.totalLuck>=80?"🌟":n.totalLuck>=60?"⭐":n.totalLuck>=40?"☆":"⚪"}),t.jsx("div",{className:"w-12 h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${n.totalLuck}%`,backgroundColor:o.color}})})]}):t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-semibold",children:"일간 운세"}),t.jsx("span",{className:"text-lg",children:o.icon||"🔮"})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"text-sm font-bold",style:{color:o.color},children:[Math.round(n.totalLuck),"%"]}),t.jsx("div",{className:"text-xs",style:{color:o.color},children:o.label})]})]}),t.jsxs("div",{className:"grid grid-cols-5 gap-1 text-xs",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"연애"}),t.jsxs("div",{className:"font-semibold",children:[Math.round(n.loveLuck),"%"]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"재물"}),t.jsxs("div",{className:"font-semibold",children:[Math.round(n.wealthLuck),"%"]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"건강"}),t.jsxs("div",{className:"font-semibold",children:[Math.round(n.healthLuck),"%"]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"직업"}),t.jsxs("div",{className:"font-semibold",children:[Math.round(n.careerLuck),"%"]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"학업"}),t.jsxs("div",{className:"font-semibold",children:[Math.round(n.studyLuck),"%"]})]})]}),!a&&t.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-700 flex items-center gap-2 text-xs",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300",style:{backgroundColor:n.luckyColor},title:`행운의 색: ${n.luckyColor}`}),t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"색상"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"font-bold",children:n.luckyNumber}),t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"숫자"})]})]}),!a&&n.message&&t.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400 italic",children:["💡 ",n.message]})]})},he=({startTime:r,endTime:a,compact:s=!1,showTooltip:l=!0})=>{const n=e.useMemo(()=>{const e="string"==typeof r?new Date(r):r,t=a?"string"==typeof a?new Date(a):a:void 0;return I(e,t)},[r,a]),o=e=>({excellent:"대길",good:"길",neutral:"평",bad:"흉",terrible:"대흉"}[e]);return s?t.jsx("span",{className:`inline-flex items-center justify-center text-xs ${H(n.fortune)}`,title:l?`귀문둔갑: ${o(n.fortune)} (${n.score}점)`:void 0,children:P(n.fortune)}):t.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-md bg-muted/50 border border-border",children:[t.jsx("span",{className:"text-sm",children:P(n.fortune)}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:`text-xs font-medium ${H(n.fortune)}`,children:o(n.fortune)}),t.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[n.score,"점"]})]})]})},be=["일","월","화","수","목","금","토"];function pe({events:r,onCreateEvent:a,onDateClick:s,onEditEvent:n,onDeleteEvent:o,highlightedEventId:i}){const{currentDate:g,getTodosForDate:b,deleteTodo:p}=l(),[N,k]=e.useState(null),[w,C]=e.useState(!1),[M,D]=e.useState(new Date),[S,E]=e.useState(null),{diaryDates:L}=A({viewMode:"month",currentDate:g}),$=e.useMemo(()=>{const e=d(g),t=c(g),r=x(e,{weekStartsOn:0}),a=m(t,{weekStartsOn:0});return y({start:r,end:a})},[g]),T=e.useMemo(()=>{const e=new Map,t=new Set;return $.forEach(r=>{if(f(r,g)){const a=u(r,"yyyy-MM-dd"),s=z(r);s&&(t.has(s)||(t.add(s),e.set(a,s)))}}),e},[$,g]),_=e.useMemo(()=>{const e=new Map;return $.forEach(t=>{const r=u(t,"yyyy-MM-dd");e.set(r,b(t))}),e},[$,b]),O=e=>{switch(e){case"high":return"🔴";case"medium":return"🟡";case"low":return"🟢";default:return"⚪"}};return t.jsxs("div",{className:"h-full flex flex-col bg-background",children:[t.jsxs("div",{className:"relative grid grid-cols-7 border-b border-border bg-gradient-to-r from-hanbok-white via-white to-hanbok-white",children:[t.jsx(V,{pattern:"clouds",opacity:.05}),be.map((e,r)=>t.jsxs("div",{className:`\n              relative px-2 py-4 text-center font-bold tracking-wider\n              ${0===r?"text-hanbok-red":6===r?"text-hanbok-blue":"text-gray-700 dark:text-gray-300"}\n              ${0===r||6===r?"text-base":"text-sm"}\n              transition-colors duration-200 hover:bg-white/50\n            `,children:[t.jsx("span",{className:"relative z-10",children:e}),(0===r||6===r)&&t.jsx("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2 w-6 h-0.5 bg-current opacity-30 rounded"})]},e))]}),t.jsx("div",{className:"flex-1 grid grid-cols-7 grid-rows-6 gap-px bg-border",children:$.map(e=>{const l=v(e),d=f(e,g),c=h(e),x=(m=e,r.filter(e=>{const t=new Date(e.start_time);return j(t,m)}).slice(0,3));var m;const b=u(e,"yyyy-MM-dd"),y=_.get(b)||[],w=y.filter(e=>!e.completed),M=y.filter(e=>e.completed),S=T.get(b)||null;return t.jsxs("div",{onClick:t=>((e,t)=>{s?s(e,t):a(e)})(e,t),onMouseEnter:()=>k(e),onMouseLeave:()=>k(null),className:`\n                relative p-2 cursor-pointer transition-all duration-200 group\n                bg-background hover:bg-gradient-to-br hover:from-hanbok-white hover:to-white\n                ${d?"":"bg-muted/30"}\n                ${c?"bg-gradient-to-br from-hanbok-yellow/20 to-yinyang-yang/10 shadow-inner border-2 border-yinyang-yang/30":""}\n                ${0===l?"hover:from-hanbok-red/5 hover:to-red-50":""}\n                ${6===l?"hover:from-hanbok-blue/5 hover:to-blue-50":""}\n                min-h-[120px] border border-gray-100 dark:border-gray-800\n              `,children:[t.jsxs("div",{className:"flex items-start justify-between mb-1",children:[t.jsxs("div",{className:"flex flex-col space-y-1",children:[t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx("span",{className:`\n                        font-bold transition-all duration-200\n                        ${c?"bg-gradient-to-br from-yinyang-yang to-hanbok-yellow text-white rounded-full w-8 h-8 flex items-center justify-center shadow-lg text-sm":"text-base"}\n                        ${d?"":"text-muted-foreground opacity-50"}\n                        ${0===l?"text-hanbok-red":""}\n                        ${6===l?"text-hanbok-blue":""}\n                        group-hover:scale-110\n                      `,children:u(e,"d")}),c&&t.jsx("span",{className:"text-xs animate-pulse",children:"✨"})]}),t.jsx("div",{className:"flex flex-col",children:S&&t.jsx("span",{className:"text-[9px] text-hanbok-red font-bold bg-hanbok-red/10 px-1 py-0.5 rounded mt-0.5 truncate",children:S})})]}),d&&t.jsxs("div",{className:"flex items-center gap-1",children:[L.has(u(e,"yyyy-MM-dd"))&&t.jsx("button",{onClick:t=>{t.stopPropagation(),(e=>{D(e),C(!0)})(e)},className:"p-1 rounded text-xs transition-all hover:scale-110 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400",title:"일기 보기/수정",children:"📖"}),y.length>0&&t.jsxs(t.Fragment,{children:[w.filter(e=>"high"===e.priority).length>0&&t.jsx("span",{className:"flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-red-500 rounded-full",children:w.filter(e=>"high"===e.priority).length}),w.filter(e=>"medium"===e.priority).length>0&&t.jsx("span",{className:"flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-yellow-500 rounded-full",children:w.filter(e=>"medium"===e.priority).length}),w.filter(e=>"low"===e.priority).length>0&&t.jsx("span",{className:"flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-green-500 rounded-full",children:w.filter(e=>"low"===e.priority).length}),M.length>0&&t.jsx("span",{className:"flex items-center justify-center w-5 h-5 text-xs font-bold text-gray-500 bg-gray-200 rounded-full",children:"✓"})]})]})]}),t.jsxs("div",{className:"space-y-1",children:[x.map(e=>t.jsxs("div",{className:"text-xs p-1 rounded cursor-pointer hover:opacity-80 group flex items-center "+(i===e.id?"ring-2 ring-primary animate-pulse":""),style:{backgroundColor:`${e.color||"#3b82f6"}20`,color:e.color||"#3b82f6",borderLeft:`2px solid ${e.color||"#3b82f6"}`},onClick:t=>((e,t)=>{t.stopPropagation(),n(e)})(e,t),children:[t.jsxs("span",{className:"flex-1 truncate flex items-center gap-1",children:[!e.all_day&&t.jsx(he,{startTime:e.start_time,endTime:e.end_time,compact:!0}),e.all_day&&t.jsx("span",{className:"font-semibold",children:"종일 "}),!e.all_day&&u(new Date(e.start_time),"HH:mm")," ",e.title]}),o&&t.jsx("button",{onClick:t=>{t.stopPropagation(),confirm(`"${e.title}" 일정을 삭제하시겠습니까?`)&&(null==o||o(e.id))},className:"opacity-50 hover:opacity-100 text-red-500 hover:text-red-700 transition-opacity ml-1 text-lg font-bold",title:"일정 삭제",children:"×"})]},e.id)),r.filter(t=>t.id&&j(new Date(t.start_time),e)).length>3&&t.jsxs("div",{className:"text-xs text-muted-foreground font-medium",children:["+",r.filter(t=>t.id&&j(new Date(t.start_time),e)).length-3,"개 더보기"]})]}),d&&t.jsx(ge,{date:e,compact:!0}),N&&j(N,e)&&y.length>0&&t.jsxs("div",{className:"absolute z-50 top-full left-0 mt-2 w-64 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-3",children:[t.jsxs("div",{className:"text-sm font-semibold mb-2 text-gray-800 dark:text-gray-200",children:["할일 목록 (",y.length,"개)"]}),t.jsxs("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:[y.slice(0,5).map(e=>t.jsxs("div",{className:"flex items-start gap-2 text-xs group",children:[t.jsx("span",{children:O(e.priority)}),t.jsx("span",{className:"flex-1 cursor-pointer hover:underline "+(e.completed?"line-through text-gray-500":"text-gray-700 dark:text-gray-300"),onClick:t=>{t.stopPropagation(),E(e)},children:e.text}),t.jsx("button",{onClick:t=>{t.stopPropagation(),E(e)},className:"opacity-0 group-hover:opacity-100 text-blue-500 hover:text-blue-700 transition-opacity text-xs",title:"할일 수정",children:"✏️"}),t.jsx("button",{onClick:t=>{t.stopPropagation(),p(e.id)},className:"opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 transition-opacity",title:"할일 삭제",children:"×"})]},e.id)),y.length>5&&t.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["+",y.length-5,"개 더보기"]})]})]})]},e.toISOString())})}),t.jsx(J,{isOpen:w,onClose:()=>C(!1),date:M,onSave:()=>C(!1)}),t.jsx(G,{isOpen:!!S,onClose:()=>E(null),todo:S})]})}function ye({date:r,hour:a,onClose:s,onAddEvent:l,onAddTodo:n}){const[o,i]=e.useState("event"),[d,c]=e.useState(""),[x,m]=e.useState(""),[g,h]=e.useState(a?`${a.toString().padStart(2,"0")}:00`:"09:00"),[b,p]=e.useState(a?`${(a+1).toString().padStart(2,"0")}:00`:"10:00"),[y,f]=e.useState("medium"),[v,j]=e.useState(Boolean(a));return t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-auto",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[u(r,"M월 d일")," 항목 추가"]}),t.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:t.jsx(L,{className:"h-5 w-5 text-gray-500"})})]}),t.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),d.trim()){if("event"===o){const e=new Date(r),[t,a]=g.split(":").map(Number);e.setHours(t,a,0,0);const s=new Date(r),[n,o]=b.split(":").map(Number);s.setHours(n,o,0,0),l({title:d.trim(),description:x.trim()||void 0,start_time:e.toISOString(),end_time:s.toISOString(),all_day:!1,location:void 0,color:"#3b82f6"})}else{const e={text:d.trim(),description:x.trim()||void 0,completed:!1,priority:y,date:u(r,"yyyy-MM-dd"),hasTime:v,startTime:v?g:void 0,endTime:v?b:void 0};n(e)}s()}},className:"p-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 block mb-2",children:"추가할 항목"}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"radio",name:"itemType",value:"event",checked:"event"===o,onChange:e=>i(e.target.value),className:"mr-2"}),t.jsx("span",{className:"text-sm",children:"📅 일정"})]}),t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"radio",name:"itemType",value:"todo",checked:"todo"===o,onChange:e=>i(e.target.value),className:"mr-2"}),t.jsx("span",{className:"text-sm",children:"✅ 할일"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 block mb-2",children:"event"===o?"일정 제목":"할일 내용"}),t.jsx("input",{type:"text",value:d,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"event"===o?"일정 제목을 입력하세요":"할일을 입력하세요",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 block mb-2",children:"설명 (선택사항)"}),t.jsx("textarea",{value:x,onChange:e=>m(e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white resize-none",placeholder:"추가 설명을 입력하세요"})]}),"todo"===o&&t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 block mb-2",children:"우선순위"}),t.jsxs("select",{value:y,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",children:[t.jsx("option",{value:"high",children:"🔴 높음"}),t.jsx("option",{value:"medium",children:"🟡 보통"}),t.jsx("option",{value:"low",children:"🟢 낮음"})]})]}),t.jsxs("div",{children:["todo"===o&&t.jsx("div",{className:"mb-3",children:t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:v,onChange:e=>j(e.target.checked),className:"mr-2"}),t.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"시간 지정"})]})}),("event"===o||v)&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 block mb-2",children:"시작 시간"}),t.jsx("input",{type:"time",value:g,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 block mb-2",children:"event"===o?"종료 시간":"종료 시간 (선택)"}),t.jsx("input",{type:"time",value:b,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:"event"===o})]})]})]}),t.jsxs("div",{className:"flex space-x-3 pt-4",children:[t.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"취소"}),t.jsx("button",{type:"submit",disabled:!d.trim(),className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"event"===o?"일정 추가":"할일 추가"})]})]})]})})}const fe={event:{background:"#3b82f620",border:"#3b82f6",text:"#3b82f6"},todo:{high:{background:"#ef444420",border:"#ef4444",text:"#ef4444"},medium:{background:"#f59e0b20",border:"#f59e0b",text:"#f59e0b"},low:{background:"#10b98120",border:"#10b981",text:"#10b981"}}},ve=Array.from({length:11},(e,t)=>t+9);function je({events:r,onCreateEvent:a,onDateClick:s,onEditEvent:n,onDeleteEvent:o,highlightedEventId:i}){const{currentDate:d,getTodosForDate:c,addTodo:g,deleteTodo:b,toggleTodo:f}=l(),[v,k]=e.useState(!1),[w,C]=e.useState(new Date),[M,D]=e.useState(),[S,E]=e.useState(!1),[L,$]=e.useState(new Date),[T,_]=e.useState(null),{diaryDates:O}=A({viewMode:"week",currentDate:d}),F=e.useMemo(()=>{const e=x(d,{weekStartsOn:0}),t=m(d,{weekStartsOn:0});return y({start:e,end:t})},[d]),I=e=>{switch(e){case"high":return"🔴";case"medium":return"🟡";case"low":return"🟢";default:return""}},P=e=>{$(e),E(!0)},H=(new Date).getHours(),B=(new Date).getMinutes(),z=(60*H+B)/1440*100,R=e.useMemo(()=>{const e=new Map;return F.forEach(t=>{const a=u(t,"yyyy-MM-dd"),s=r.filter(e=>{if(!e.all_day||!e.start_time)return!1;try{const r=new Date(e.start_time);return!isNaN(r.getTime())&&j(r,t)}catch{return!1}});e.set(a,s)}),e},[r,F]);return t.jsxs("div",{className:"h-full flex flex-col bg-background",children:[t.jsxs("div",{className:"grid grid-cols-8 border-b border-border bg-muted sticky top-0 z-10",children:[t.jsx("div",{className:"p-3 text-center text-sm font-semibold text-muted-foreground",children:"시간"}),F.map(e=>{const r=e.getDay(),a=h(e);return t.jsxs("div",{className:`\n                p-3 text-center border-l border-border\n                ${a?"bg-primary/10":""}\n              `,children:[t.jsx("div",{className:"text-xs font-medium "+(0===r?"text-red-600":6===r?"text-blue-600":"text-muted-foreground"),children:u(e,"EEE",{locale:p})}),t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx("div",{className:"text-lg font-semibold "+(a?"text-primary":"text-foreground"),children:u(e,"d")}),O.has(u(e,"yyyy-MM-dd"))&&t.jsx("button",{onClick:()=>P(e),className:"p-1 rounded-full text-xs transition-all hover:scale-110 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400",title:"일기 보기/수정",children:"📖"})]})]},e.toISOString())})]}),Array.from(R.values()).some(e=>e.length>0)&&t.jsxs("div",{className:"grid grid-cols-8 border-b border-border bg-muted/30",children:[t.jsx("div",{className:"p-2 text-center text-xs font-semibold text-muted-foreground border-r border-border",children:"종일"}),F.map(e=>{const r=u(e,"yyyy-MM-dd"),a=R.get(r)||[];return t.jsx("div",{className:"p-1 border-l border-border",children:a.map(e=>t.jsxs("div",{className:"text-xs p-1 mb-1 rounded truncate cursor-pointer hover:opacity-80 group flex items-center justify-between",style:{backgroundColor:fe.event.background,color:fe.event.text,borderLeft:`2px solid ${fe.event.border}`},onClick:t=>{t.stopPropagation(),n(e)},children:[t.jsxs("span",{className:"truncate flex items-center gap-1",children:[t.jsx(he,{startTime:e.start_time,endTime:e.end_time,compact:!0}),e.title]}),o&&t.jsx("button",{onClick:t=>{t.stopPropagation(),confirm(`"${e.title}" 일정을 삭제하시겠습니까?`)&&o(e.id)},className:"opacity-60 hover:opacity-100 text-red-500 hover:text-red-700 transition-opacity ml-1 flex-shrink-0 text-sm font-bold",title:"일정 삭제",children:"×"})]},e.id))},`allday-${e.toISOString()}`)})]}),t.jsx("div",{className:"flex-1 overflow-auto",children:t.jsxs("div",{className:"relative",children:[F.some(e=>h(e))&&t.jsx("div",{className:"absolute left-0 right-0 z-20 pointer-events-none",style:{top:`${z}%`},children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-16"}),t.jsx("div",{className:"flex-1 h-0.5 bg-red-500"}),t.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full -ml-1"})]})}),t.jsxs("div",{className:"grid grid-cols-8",children:[t.jsx("div",{className:"border-r border-border",children:ve.map(e=>t.jsx("div",{className:"h-16 px-2 py-1 text-xs text-muted-foreground text-right",children:u((new Date).setHours(e,0,0,0),"HH:mm")},e))}),F.map(e=>{const a=h(e);return t.jsx("div",{className:"border-r border-border",children:ve.map(l=>{const i=((e,t)=>r&&0!==r.length?r.filter(r=>{if(!r.start_time)return!1;try{const a=new Date(r.start_time);if(isNaN(a.getTime()))return!1;const s=N(a);return j(a,e)&&s===t}catch(a){return!1}}):[])(e,l),d=((e,t)=>c(e).filter(e=>{if(!e.hasTime||!e.startTime)return!1;try{const[r]=e.startTime.split(":").map(Number);return r===t}catch(r){return!1}}))(e,l);return t.jsxs("div",{className:`\n                          h-16 border-b border-border/50 p-1 cursor-pointer\n                          hover:bg-muted/50 transition-colors\n                          ${a&&H===l?"bg-primary/10":""}\n                        `,onClick:t=>{s?s(e,t):(C(new Date(e)),D(l),k(!0))},children:[i.map(e=>{if(!e.id||!e.start_time||!e.title)return null;try{const r=new Date(e.start_time);return isNaN(r.getTime())?null:t.jsxs("div",{className:"text-xs p-1 mb-1 rounded truncate cursor-pointer hover:opacity-80 group flex items-center justify-between",style:{backgroundColor:fe.event.background,color:fe.event.text,borderLeft:`2px solid ${fe.event.border}`},onClick:t=>{t.stopPropagation(),n(e)},children:[t.jsxs("span",{className:"truncate flex items-center gap-1",children:[t.jsx(he,{startTime:e.start_time,endTime:e.end_time,compact:!0}),u(r,"HH:mm")," ",e.title]}),o&&t.jsx("button",{onClick:t=>{t.stopPropagation(),confirm(`"${e.title}" 일정을 삭제하시겠습니까?`)&&o(e.id)},className:"opacity-60 hover:opacity-100 text-red-500 hover:text-red-700 transition-opacity ml-1 flex-shrink-0 text-sm font-bold",title:"일정 삭제",children:"×"})]},e.id)}catch(r){return null}}),d.map(e=>{const r=fe.todo[e.priority];return t.jsxs("div",{className:"text-xs p-1 mb-1 rounded truncate cursor-pointer hover:opacity-80 flex items-center space-x-1",style:{backgroundColor:r.background,color:r.text,borderLeft:`2px solid ${r.border}`},onClick:e=>{e.stopPropagation()},children:[t.jsx("button",{onClick:t=>{t.stopPropagation(),f(e.id)},className:`\n                                w-2 h-2 rounded-full border flex items-center justify-center text-xs\n                                ${e.completed?"bg-green-500 border-green-500 text-white":"border-orange-400"}\n                              `,children:e.completed&&"✓"}),t.jsx("span",{className:"text-xs",children:I(e.priority)}),t.jsxs("span",{className:"flex-1 "+(e.completed?"line-through opacity-60":""),children:[e.startTime," ",e.text]})]},e.id)})]},`${e.toISOString()}-${l}`)})},e.toISOString())})]}),t.jsx("div",{className:"mt-4 border-t border-border",children:t.jsxs("div",{className:"grid grid-cols-8 bg-border gap-px",children:[t.jsx("div",{className:"bg-muted p-3 text-center text-sm font-semibold text-muted-foreground",children:"할일"}),F.map(e=>{const r=c(e).filter(e=>!e.hasTime||!e.startTime);const a=h(e);return t.jsxs("div",{className:`\n                    bg-background p-3 min-h-[120px]\n                    ${a?"bg-primary/5":""}\n                  `,children:[O.has(u(e,"yyyy-MM-dd"))&&t.jsx("div",{className:"mb-2 flex items-center",children:t.jsxs("button",{onClick:()=>P(e),className:"p-1 rounded text-xs transition-all hover:scale-105 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400",title:"일기 보기/수정",children:["📖 ",t.jsx("span",{className:"ml-1 text-xs",children:"일기"})]})}),t.jsx("div",{className:"space-y-1 mb-2",children:r.map(e=>t.jsxs("div",{className:"flex items-center space-x-1 group",children:[t.jsx("button",{onClick:()=>f(e.id),className:`\n                            w-3 h-3 rounded-full border flex items-center justify-center text-xs\n                            ${e.completed?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600"}\n                          `,children:e.completed&&"✓"}),t.jsx("span",{className:"text-xs",children:I(e.priority)}),t.jsx("span",{className:`\n                            flex-1 text-xs truncate cursor-pointer hover:underline\n                            ${e.completed?"line-through text-gray-500":"text-gray-800 dark:text-gray-200"}\n                          `,onClick:()=>_(e),children:e.text}),t.jsx("button",{onClick:()=>_(e),className:"opacity-0 group-hover:opacity-100 text-blue-500 hover:text-blue-700 text-xs",title:"수정",children:"✏️"}),t.jsx("button",{onClick:()=>b(e.id),className:"opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 text-xs",children:"×"})]},e.id))})]},`todos-${e.toISOString()}`)})]})})]})}),v&&t.jsx(ye,{date:w,hour:M,onClose:()=>k(!1),onAddEvent:e=>{a(new Date(e.start_time)),k(!1)},onAddTodo:e=>{g(e),k(!1)}}),t.jsx(J,{isOpen:S,onClose:()=>E(!1),date:L,onSave:()=>E(!1)}),t.jsx(G,{isOpen:!!T,onClose:()=>_(null),todo:T})]})}const Ne=({label:e,score:r,icon:a,description:s})=>{const l=me(r),n=Math.round(r);return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all hover:scale-105 border border-border/50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-3xl",children:a}),t.jsx("h3",{className:"text-xl font-bold text-foreground",children:e})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"text-2xl font-bold",style:{color:l.color},children:[n,"%"]}),t.jsx("div",{className:"text-sm font-medium",style:{color:l.color},children:l.label})]})]}),t.jsx("div",{className:"w-full h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full transition-all duration-1000 ease-out",style:{width:`${n}%`,backgroundColor:l.color,boxShadow:`0 0 10px ${l.color}40`}})}),s&&t.jsx("p",{className:"text-sm text-muted-foreground mt-3 italic",children:s})]})},ke=()=>t.jsxs("div",{className:"h-full flex flex-col",children:[t.jsxs("h2",{className:"text-3xl font-bold text-foreground mb-8 flex items-center gap-3",children:[t.jsx("span",{className:"animate-pulse",children:"✨"}),"오늘의 운세"]}),t.jsx("div",{className:"grid grid-cols-1 gap-6 flex-1",children:[1,2,3,4,5].map(e=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 animate-pulse",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-muted rounded"}),t.jsx("div",{className:"w-24 h-6 bg-muted rounded"})]}),t.jsx("div",{className:"w-16 h-8 bg-muted rounded"})]}),t.jsx("div",{className:"w-full h-4 bg-muted rounded-full"})]},e))})]}),we=()=>{const e=a(),{user:r}=n();return t.jsx("div",{className:"h-full flex flex-col items-center justify-center",children:t.jsxs("div",{className:"max-w-md text-center",children:[t.jsx("div",{className:"text-6xl mb-6",children:"🔮"}),t.jsx("h2",{className:"text-3xl font-bold text-foreground mb-4",children:"운세를 확인하려면 설정이 필요합니다"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-8",children:"생년월일시 정보를 입력하여 맞춤 운세를 받아보세요"}),t.jsx("button",{onClick:()=>{e("/settings")},className:"px-8 py-4 bg-primary-500 text-white text-lg font-semibold rounded-xl hover:bg-primary-600 transition-colors shadow-lg",children:"설정하러 가기"}),r&&t.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:[t.jsxs("p",{children:["로그인된 계정: ",r.email]}),t.jsx("p",{className:"text-xs mt-1",children:"설정 페이지에서 생년월일시를 입력하면 자동으로 운세가 계산됩니다"})]})]})})},Ce={"총운":"하루 전반적인 운의 흐름을 나타냅니다","연애운":"사랑과 인간관계의 조화를 보여줍니다","재물운":"금전적 이득과 재산 증식의 기회를 알려줍니다","건강운":"신체와 정신의 건강 상태를 나타냅니다","직업운":"업무 성과와 경력 발전 가능성을 보여줍니다"},Me=({currentDate:a,onDiaryClick:s,hasDiary:l})=>{const{birthInfo:o,setBirthInfo:i}=F(),{user:d}=n();r.useEffect(()=>{if(!o){const t=localStorage.getItem("sajuapp-personal-info");if(t)try{const e=JSON.parse(t);if(e.birthDate&&e.birthTime){const t=new Date(e.birthDate),[r,a]=e.birthTime.split(":").map(Number),s={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate(),hour:r||0,minute:a||0,isLunar:"lunar"===e.calendarType,isMale:"male"===e.gender,name:"male"===e.gender?"사용자(남)":"사용자(여)"};i(s)}}catch(e){}}},[o,i]);const{calculateFortune:c}=ue(),x=e.useMemo(()=>o?c(o,a):null,[o,a,c]);if(!o)return t.jsx(we,{});if(!x)return t.jsx(ke,{});const m=[{label:"총운",score:x.totalLuck,icon:"🌟"},{label:"연애운",score:x.loveLuck,icon:"💕"},{label:"재물운",score:x.wealthLuck,icon:"💰"},{label:"건강운",score:x.healthLuck,icon:"🏥"},{label:"직업운",score:x.careerLuck,icon:"💼"}];return t.jsxs("div",{className:"h-full flex flex-col p-2",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h2",{className:"text-4xl font-bold text-foreground mb-2 flex items-center gap-3",children:[t.jsx("span",{className:"text-yellow-500",children:"✨"}),"오늘의 운세"]}),t.jsx("p",{className:"text-lg text-muted-foreground",children:"당신의 사주명리로 풀어보는 오늘 하루"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6 flex-1",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsx(Ne,{label:m[0].label,score:m[0].score,icon:m[0].icon,description:Ce[m[0].label]})}),m.slice(1).map(e=>t.jsx(Ne,{label:e.label,score:e.score,icon:e.icon,description:Ce[e.label]},e.label))]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 rounded-2xl p-6 shadow-lg",children:[t.jsx("h3",{className:"text-xl font-bold text-foreground mb-4",children:"오늘의 행운 아이템"}),t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-16 rounded-full shadow-lg flex items-center justify-center bg-white dark:bg-gray-800",children:t.jsx("div",{className:"w-12 h-12 rounded-full",style:{backgroundColor:x.luckyColor},title:"행운의 색상"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"행운의 색상"}),t.jsx("div",{className:"font-bold text-lg",children:x.luckyColor})]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-500 text-white rounded-full flex items-center justify-center text-2xl font-bold shadow-lg",children:x.luckyNumber}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"행운의 숫자"}),t.jsxs("div",{className:"font-bold text-lg",children:["숫자 ",x.luckyNumber]})]})]})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 rounded-2xl p-6 shadow-lg",children:[t.jsxs("h3",{className:"text-xl font-bold text-foreground mb-3 flex items-center gap-2",children:[t.jsx("span",{children:"💌"}),"오늘의 메시지"]}),t.jsx("p",{className:"text-lg text-foreground leading-relaxed mb-3",children:x.message}),x.advice&&t.jsxs("p",{className:"text-sm text-muted-foreground italic border-t border-border/30 pt-3",children:["💡 ",x.advice]})]})]})]})},De=Array.from({length:10},(e,t)=>t+9);function Se({events:r,onCreateEvent:a,onEditEvent:s,onDeleteEvent:n}){const{currentDate:o,getTodosForDate:i,deleteTodo:d,toggleTodo:c}=l(),[x,m]=e.useState(!1),[g,h]=e.useState(null),b=e.useMemo(()=>i(o),[o,i]),y=e=>{switch(e){case"high":return"🔴";case"medium":default:return"🟡";case"low":return"🟢"}},f=e.useMemo(()=>b.filter(e=>e.hasTime&&e.startTime),[b]),v=e.useMemo(()=>b.filter(e=>!e.hasTime||!e.startTime),[b]),w=e.useMemo(()=>r.filter(e=>{const t=new Date(e.start_time);return j(t,o)}).sort((e,t)=>new Date(e.start_time).getTime()-new Date(t.start_time).getTime()),[r,o]),C=w.filter(e=>e.all_day),M=w.filter(e=>!e.all_day),D=(new Date).getHours(),S=(new Date).getMinutes(),E=D>=9&&D<=18?(60*(D-9)+S)/600*100:-1;return t.jsxs("div",{className:"h-full flex flex-col lg:flex-row bg-background",children:[t.jsxs("div",{className:"lg:w-1/2 w-full lg:border-r border-b lg:border-b-0 border-border p-6 overflow-auto bg-gradient-to-br from-background to-muted/20 h-1/2 lg:h-full",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-3xl font-bold text-foreground mb-1",children:u(o,"yyyy년 M월 d일",{locale:p})}),t.jsx("p",{className:"text-xl text-muted-foreground",children:u(o,"EEEE",{locale:p})})]}),t.jsxs("div",{className:"mb-4 p-4 rounded-lg bg-gradient-to-r from-primary-500/10 to-primary-600/10 border border-primary-500/20",children:[t.jsx("h3",{className:"text-sm font-semibold text-muted-foreground mb-3",children:"빠른 작성"}),t.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[t.jsxs("button",{onClick:()=>{const e=new Date(o);e.setHours((new Date).getHours(),0,0,0),a(e)},className:"px-3 py-2 text-sm bg-blue-500/10 hover:bg-blue-500/20 text-blue-600 rounded-md transition-colors flex items-center justify-center gap-1",children:[t.jsx("span",{children:"📅"})," 일정"]}),t.jsxs("button",{onClick:()=>{const e=new Date(o);e.setHours((new Date).getHours(),0,0,0),a(e)},className:"px-3 py-2 text-sm bg-amber-500/10 hover:bg-amber-500/20 text-amber-600 rounded-md transition-colors flex items-center justify-center gap-1",children:[t.jsx("span",{children:"✅"})," 할일"]}),t.jsxs("button",{onClick:()=>m(!0),className:"px-3 py-2 text-sm bg-purple-500/10 hover:bg-purple-500/20 text-purple-600 rounded-md transition-colors flex items-center justify-center gap-1",children:[t.jsx("span",{children:"📖"})," 일기"]})]})]}),t.jsx("div",{className:"h-full flex flex-col",children:t.jsx(Me,{currentDate:o})})]}),t.jsxs("div",{className:"lg:w-1/2 w-full overflow-auto h-1/2 lg:h-full",children:[C.length>0&&t.jsxs("div",{className:"p-4 border-b border-border bg-muted/30",children:[t.jsx("h3",{className:"text-sm font-semibold text-muted-foreground mb-2",children:"종일 일정"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:C.map(e=>t.jsxs("div",{className:"group inline-flex items-center px-3 py-1 rounded-full text-sm cursor-pointer hover:opacity-80 transition-opacity",style:{backgroundColor:e.color||"#3b82f6",color:"white"},onClick:()=>s(e),title:e.description||e.title,children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(he,{startTime:e.start_time,endTime:e.end_time,compact:!0}),e.title]}),n&&t.jsx("button",{onClick:t=>{t.stopPropagation(),confirm(`"${e.title}" 일정을 삭제하시겠습니까?`)&&n(e.id)},className:"opacity-0 group-hover:opacity-100 ml-2 hover:text-red-200 transition-opacity",title:"일정 삭제",children:"×"})]},e.id))})]}),t.jsxs("div",{className:"relative min-h-full",children:[j(o,new Date)&&E>=0&&t.jsx("div",{className:"absolute left-0 right-0 z-20 pointer-events-none",style:{top:`${E}%`},children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-20"}),t.jsx("div",{className:"flex-1 h-0.5 bg-red-500"}),t.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full -ml-1.5"})]})}),t.jsxs("div",{className:"relative",children:[De.map(e=>t.jsxs("div",{className:"flex border-b border-border/30",style:{height:"100px"},children:[t.jsx("div",{className:"w-20 px-4 py-3 text-muted-foreground text-right",children:t.jsx("div",{className:"text-xl font-semibold",children:u((new Date).setHours(e,0,0,0),"HH:mm")})}),t.jsxs("div",{className:"flex-1 relative cursor-pointer hover:bg-muted/20 transition-colors group",onClick:()=>{const t=new Date(o);t.setHours(e,0,0,0),a(t)},title:`${e}:00에 일정 추가`,children:[t.jsx("div",{className:"absolute top-1/2 left-0 right-0 border-t border-border/15"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity",children:t.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-500/20 flex items-center justify-center",children:t.jsx("span",{className:"text-primary-600 text-lg",children:"+"})})})]})]},e)),t.jsxs("div",{className:"absolute top-0 left-20 right-0 bottom-0",children:[M.map(e=>{const r=(e=>{const t=new Date(e.start_time),r=new Date(e.end_time),a=N(t),s=N(r),l=Math.max(60*(a-9)+k(t),0),n=(Math.min(60*(s-9)+k(r),600)-l)/600*100;return{top:l/600*100+"%",height:`${Math.max(n,2)}%`}})(e);return t.jsx("div",{className:"absolute left-4 right-1/2 p-4 rounded-xl cursor-pointer hover:shadow-lg transition-all hover:scale-[1.02] mr-2 group",style:{...r,backgroundColor:`${e.color||"#3b82f6"}15`,borderLeft:`4px solid ${e.color||"#3b82f6"}`,border:`1px solid ${e.color||"#3b82f6"}30`},onClick:()=>s(e),children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"text-sm font-semibold mb-1 flex items-center gap-2",style:{color:e.color||"#3b82f6"},children:[t.jsx(he,{startTime:e.start_time,endTime:e.end_time,compact:!0}),u(new Date(e.start_time),"HH:mm")," - ",u(new Date(e.end_time),"HH:mm")]}),t.jsx("div",{className:"font-semibold text-foreground text-lg mb-1",children:e.title}),e.description&&t.jsx("div",{className:"text-sm text-muted-foreground",children:e.description}),e.location&&t.jsxs("div",{className:"text-sm text-muted-foreground mt-2 flex items-center gap-1",children:[t.jsx("span",{children:"📍"})," ",e.location]})]}),n&&t.jsx("button",{onClick:t=>{t.stopPropagation(),confirm(`"${e.title}" 일정을 삭제하시겠습니까?`)&&n(e.id)},className:"opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 transition-opacity ml-2 text-lg",title:"일정 삭제",children:"×"})]})},e.id)}),f.map(e=>{const[r,a]=(e.startTime||"09:00").split(":").map(Number);new Date(o).setHours(r,a,0,0);const s=Math.max((60*(r-9)+a)/600*100,0);return t.jsx("div",{className:"absolute left-1/2 right-4 p-3 rounded-lg cursor-pointer hover:shadow-md transition-all ml-2",style:{top:`${s}%`,height:"40px",backgroundColor:e.completed?"#10b98115":"#fbbf2415",borderLeft:"3px solid "+(e.completed?"#10b981":"#fbbf24"),opacity:e.completed?.7:1},onClick:()=>c(e.id),children:t.jsxs("div",{className:"flex items-center justify-between h-full",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:e.completed,onChange:()=>c(e.id),className:"w-4 h-4",onClick:e=>e.stopPropagation()}),t.jsx("span",{className:"text-sm font-medium",children:y(e.priority)}),t.jsx("span",{className:"text-sm "+(e.completed?"line-through text-muted-foreground":""),children:e.text}),t.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",e.startTime,")"]})]}),t.jsx("button",{onClick:t=>{t.stopPropagation(),d(e.id)},className:"text-red-500 hover:text-red-700 text-sm px-2",children:"✕"})]})},e.id)})]})]})]}),v.length>0&&t.jsxs("div",{className:"p-4 border-t border-border bg-muted/10",children:[t.jsx("h3",{className:"text-sm font-semibold text-muted-foreground mb-3",children:"시간 미지정 할일"}),t.jsx("div",{className:"space-y-2",children:v.map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-background border border-border hover:shadow-sm transition-all",style:{opacity:e.completed?.6:1},children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.jsx("input",{type:"checkbox",checked:e.completed,onChange:()=>c(e.id),className:"w-4 h-4"}),t.jsx("span",{className:"text-sm font-medium",children:y(e.priority)}),t.jsx("span",{className:"text-sm flex-1 cursor-pointer hover:underline "+(e.completed?"line-through text-muted-foreground":""),onClick:()=>h(e),children:e.text})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>h(e),className:"text-blue-500 hover:text-blue-700 text-sm px-2 py-1",children:"수정"}),t.jsx("button",{onClick:()=>d(e.id),className:"text-red-500 hover:text-red-700 text-sm px-2 py-1",children:"삭제"})]})]},e.id))})]})]}),t.jsx(J,{isOpen:x,onClose:()=>m(!1),date:o,onSave:()=>{m(!1)}}),t.jsx(G,{isOpen:!!g,onClose:()=>h(null),todo:g})]})}const Ee={goal:{icon:"🎯",label:"목표",color:"#9333EA",bgColor:"bg-purple-100 dark:bg-purple-900/30",textColor:"text-purple-600 dark:text-purple-400"},event:{icon:"📅",label:"이벤트",color:"#3B82F6",bgColor:"bg-blue-100 dark:bg-blue-900/30",textColor:"text-blue-600 dark:text-blue-400"},memo:{icon:"📝",label:"메모",color:"#EAB308",bgColor:"bg-yellow-100 dark:bg-yellow-900/30",textColor:"text-yellow-600 dark:text-yellow-400"},milestone:{icon:"🏆",label:"마일스톤",color:"#22C55E",bgColor:"bg-green-100 dark:bg-green-900/30",textColor:"text-green-600 dark:text-green-400"}},Le={high:{icon:"🔴",label:"높음"},medium:{icon:"🟡",label:"보통"},low:{icon:"🟢",label:"낮음"}},$e=["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"];function Te({_events:r,_onCreateEvent:a,_onEditEvent:s,_onDateClick:n,_highlightedEventId:i}){const{currentDate:d,setCurrentDate:c,setViewMode:x}=l(),{getMemosByMonth:m,addMemo:u,deleteMemo:g,toggleComplete:h,getMonthStatistics:b}=o(),{diaries:p}=A({viewMode:"year",currentDate:d}),y=d.getFullYear(),[f,v]=e.useState(null),[j,N]=e.useState(null),[k,w]=e.useState(null),[C,M]=e.useState("all"),[D,S]=e.useState(""),[E,L]=e.useState(""),[F,I]=e.useState("memo"),[P,H]=e.useState("medium"),[B,z]=e.useState(""),R=e=>{if(!E.trim())return;u({year:y,month:e,type:F,title:E,description:B,color:Ee[F].color,importance:P,completed:!1,position:0}),L(""),z(""),I("memo"),H("medium"),N(null)},W=e=>{if(!p||0===p.length)return 0;const t=String(e).padStart(2,"0"),r=`${y}-${t}`;return p.filter(e=>e.date&&e.date.startsWith(r)).length},Q=e.useMemo(()=>{let e=0,t=0;const r={goal:0,event:0,memo:0,milestone:0};for(let a=1;a<=12;a++){const s=b(y,a);e+=s.total,t+=s.completed,Object.entries(s.byType).forEach(([e,t])=>{r[e]+=t})}return{totalMemos:e,completedMemos:t,typeCount:r}},[y,b]);return t.jsx("div",{className:"h-full overflow-auto bg-background p-4",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 mb-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:[y,"년 연간 계획"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"검색...",value:D,onChange:e=>S(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg \n                           bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100\n                           focus:ring-2 focus:ring-purple-500"})]}),t.jsxs("select",{value:C,onChange:e=>M(e.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg \n                         bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[t.jsx("option",{value:"all",children:"모든 타입"}),Object.entries(Ee).map(([e,r])=>t.jsxs("option",{value:e,children:[r.icon," ",r.label]},e))]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[t.jsxs("div",{className:"text-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:Q.totalMemos}),t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"전체"})]}),t.jsxs("div",{className:"text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:Q.completedMemos}),t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"완료"})]}),Object.entries(Ee).map(([e,r])=>t.jsxs("div",{className:`text-center p-3 rounded-lg ${r.bgColor}`,children:[t.jsx("div",{className:`text-2xl font-bold ${r.textColor}`,children:Q.typeCount[e]||0}),t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.label})]},e))]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:$e.map((e,r)=>{const a=r+1,s=(e=>{let t=m(y,e);if("all"!==C&&(t=t.filter(e=>e.type===C)),D){const e=D.toLowerCase();t=t.filter(t=>{var r;return t.title.toLowerCase().includes(e)||(null==(r=t.description)?void 0:r.toLowerCase().includes(e))})}return t})(a),l=b(y,a),n=j===a;return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md \n                         transition-all duration-200 border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:e}),t.jsx("button",{onClick:()=>N(n?null:a),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:t.jsx(T,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})})]}),t.jsxs("div",{className:"mt-2 flex gap-2 text-xs",children:[l.total>0&&t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[l.total,"개 항목"]}),l.completed>0&&t.jsxs("span",{className:"text-green-600 dark:text-green-400",children:[l.completed,"개 완료"]})]}),W(a)>0&&t.jsxs("span",{className:"text-purple-600 dark:text-purple-400 font-medium",children:["📔 ",W(a)]})]})]}),t.jsxs("div",{className:"p-4 space-y-2 max-h-64 overflow-y-auto",children:[n&&t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg space-y-2",children:[t.jsx("input",{type:"text",placeholder:"제목 입력...",value:E,onChange:e=>L(e.target.value),onKeyPress:e=>"Enter"===e.key&&R(a),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 \n                                 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",autoFocus:!0}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("select",{value:F,onChange:e=>I(e.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 \n                                   rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:Object.entries(Ee).map(([e,r])=>t.jsx("option",{value:e,children:r.label},e))}),t.jsx("select",{value:P,onChange:e=>H(e.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 \n                                   rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:Object.entries(Le).map(([e,r])=>t.jsx("option",{value:e,children:r.label},e))})]}),t.jsxs("div",{className:"flex gap-1 justify-end",children:[t.jsx("button",{onClick:()=>R(a),className:"px-2 py-1 text-xs bg-purple-600 text-white rounded hover:bg-purple-700",children:"추가"}),t.jsx("button",{onClick:()=>{N(null),L("")},className:"px-2 py-1 text-xs bg-gray-300 dark:bg-gray-600 text-gray-700 \n                                   dark:text-gray-300 rounded hover:bg-gray-400 dark:hover:bg-gray-500",children:"취소"})]})]}),0!==s.length||n?s.slice(0,5).map(e=>{const r=Ee[e.type];return e.id,t.jsx("div",{className:`p-2 rounded-lg border ${e.completed?"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600":`${r.bgColor} border-gray-200 dark:border-gray-600`} group hover:shadow-sm transition-all`,children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("button",{onClick:()=>h(e.id),className:"mt-0.5 w-4 h-4 rounded border-2 flex items-center justify-center\n                                "+(e.completed?"bg-green-500 border-green-500":"border-gray-300 dark:border-gray-600 hover:border-purple-500"),children:e.completed&&t.jsx(_,{className:"w-3 h-3 text-white"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-sm",children:r.icon}),t.jsx("span",{className:"text-sm font-medium "+(e.completed?"line-through text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-gray-100"),children:e.title})]}),e.description&&t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:e.description})]}),t.jsx("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:t.jsx("button",{onClick:()=>g(e.id),className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded",children:t.jsx(O,{className:"w-3 h-3 text-red-500"})})})]})},e.id)}):t.jsx("div",{className:"text-center text-gray-400 dark:text-gray-500 text-sm py-4",children:"메모가 없습니다"}),s.length>5&&t.jsxs("button",{onClick:()=>{c(new Date(y,r,1)),x("month")},className:"w-full text-center text-xs text-purple-600 dark:text-purple-400 \n                               hover:text-purple-700 dark:hover:text-purple-300 py-1",children:["+",s.length-5,"개 더 보기"]})]})]},a)})})]})})}function _e({isOpen:r,onClose:a,date:s,position:l,onSelectAction:n}){const o=e.useRef(null);if(e.useEffect(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&a()},t=e=>{"Escape"===e.key&&a()};return r&&(document.addEventListener("mousedown",e),document.addEventListener("keydown",t)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[r,a]),!r)return null;const i={x:Math.min(l.x,window.innerWidth-200),y:Math.min(l.y,window.innerHeight-160)};return t.jsx("div",{className:"fixed inset-0 z-50",style:{background:"rgba(0, 0, 0, 0.1)"},children:t.jsxs("div",{ref:o,className:"absolute bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 p-4 min-w-[240px] max-w-[280px]",style:{left:i.x,top:i.y},children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"작업 선택"}),t.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 text-lg",children:"✕"})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:(d=s,new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"long"}).format(d))})]}),t.jsx("div",{className:"space-y-2",children:[{type:"event",icon:"📅",label:"일정,할일 추가",description:"새로운 일정과 할일을 만듭니다",color:"text-blue-600 dark:text-blue-400"},{type:"diary",icon:"📝",label:"일기 쓰기",description:"오늘의 일기를 작성합니다",color:"text-purple-600 dark:text-purple-400"}].map(e=>t.jsx("button",{onClick:()=>{return t=e.type,n(t),void a();var t},className:"w-full text-left p-3 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-150 group",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("span",{className:"text-xl flex-shrink-0",children:e.icon}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:`text-sm font-medium ${e.color} group-hover:opacity-80`,children:e.label}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e.description})]}),t.jsx("div",{className:"text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-300 transition-colors",children:"→"})]})},e.type))}),t.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-600",children:t.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center",children:"ESC 키로 닫기"})})]})});var d}const Oe=({className:e})=>t.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),Fe=({className:e})=>t.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})});function Ie(){const{currentDate:r,setCurrentDate:a,viewMode:s,setViewMode:n,navigatePrevious:o,navigateNext:d,navigateToday:c}=l(),[x,m]=e.useState([]),[g,h]=e.useState(null),[b,y]=e.useState(!1),[f,v]=e.useState(null),[j,N]=e.useState(""),[k,w]=e.useState([]),[C,M]=e.useState(null),[D,S]=e.useState(!1),[E,L]=e.useState({x:0,y:0}),[$,T]=e.useState(null),[_,O]=e.useState(!1),[F,I]=e.useState(null),P=e=>{I(e),O(!0)};e.useEffect(()=>{H()},[]),e.useEffect(()=>{if(j){const e=x.filter(e=>{var t,r;return e.title.toLowerCase().includes(j.toLowerCase())||(null==(t=e.description)?void 0:t.toLowerCase().includes(j.toLowerCase()))||(null==(r=e.location)?void 0:r.toLowerCase().includes(j.toLowerCase()))});w(e)}else w(x)},[j,x]);const H=async()=>{try{const e=await i.getEvents();m(e)}catch(e){}},z=e=>{v(e||null),h(null),y(!0)},A=e=>{h(e),y(!0)},R=async e=>{try{await i.deleteEvent(e),H()}catch(t){}},W=(e,t)=>{T(e),L({x:t.clientX,y:t.clientY}),S(!0)},Q={year:"년",month:"월",week:"주",day:"일"};return t.jsxs("div",{className:"h-screen flex flex-col",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:t.jsxs("div",{className:"flex flex-col space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:(()=>{switch(s){case"year":return u(r,"yyyy년",{locale:p});case"month":return u(r,"yyyy년 M월",{locale:p});case"week":return u(r,"yyyy년 M월 w주차",{locale:p});case"day":return u(r,"yyyy년 M월 d일 EEEE",{locale:p});default:return""}})()}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:["year","month","week","day"].map(e=>t.jsx("button",{onClick:()=>n(e),className:`\n                    px-3 py-1 rounded-md text-sm font-medium transition-colors\n                    ${s===e?"bg-white dark:bg-gray-600 text-purple-600 dark:text-purple-400 shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100"}\n                  `,children:Q[e]},e))}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:o,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:t.jsx(Oe,{className:"w-5 h-5"})}),t.jsx("button",{onClick:c,className:"px-3 py-1 text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"오늘"}),t.jsx("button",{onClick:d,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:t.jsx(Fe,{className:"w-5 h-5"})})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"flex-1 max-w-md relative",children:[t.jsx("input",{type:"text",placeholder:"일정, 할일, 일기 검색...",value:j,onChange:e=>N(e.target.value),onKeyDown:e=>{"Enter"===e.key?(()=>{if(0===k.length||!j)return;const e=k[0],t=new Date(e.start_time);a(t),"year"===s&&n("month"),M(e.id||null),setTimeout(()=>{M(null)},3e3)})():"Escape"===e.key&&(N(""),M(null))},className:"w-full px-4 py-2 pl-10 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white"}),t.jsx("svg",{className:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),j&&t.jsx("button",{onClick:()=>N(""),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),j&&t.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[k.length,"개의 결과"]})]})]})}),t.jsx("div",{className:"flex-1 overflow-hidden",children:(()=>{const e={events:j?k:x,onCreateEvent:z,onDateClick:W,onEditEvent:A,onDeleteEvent:R,highlightedEventId:C,onDiaryClick:P},r={_events:e.events,_onCreateEvent:e.onCreateEvent,_onDateClick:e.onDateClick,_onEditEvent:e.onEditEvent,_highlightedEventId:e.highlightedEventId};switch(s){case"year":return t.jsx(Te,{...r});case"month":default:return t.jsx(pe,{...e});case"week":return t.jsx(je,{...e});case"day":return t.jsx(Se,{...e})}})()}),t.jsx(B,{isOpen:b,onClose:()=>{y(!1),h(null),v(null)},onSave:e=>{H()},event:g,initialDate:f||void 0}),t.jsx(_e,{isOpen:D,onClose:()=>{S(!1),T(null)},date:$||new Date,position:E,onSelectAction:e=>{if($){switch(e){case"event":v($),h(null),y(!0);break;case"diary":I($),O(!0)}S(!1)}}}),t.jsx(J,{isOpen:_,onClose:()=>{O(!1),I(null)},date:F||new Date})]})}export{Ie as default};
