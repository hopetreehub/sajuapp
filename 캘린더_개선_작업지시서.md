# 운명나침반 캘린더 개선 작업지시서

## 📋 작업 개요
- **작업일**: 2025-08-28
- **담당자**: Claude Code
- **목표**: 캘린더 일간 뷰 UX 개선 및 사주 기반 개인화 시스템 구축

## 🎯 주요 개선사항

### 1. 일간 뷰 시간 단위 개선 ⏰
**현재**: 0시-23시 (24시간 전체)
**개선**: 9시-18시 (업무시간 중심)

#### 작업 내용
- `DayView.tsx`: HOURS 배열을 9-18시로 제한
- `DayViewEnhanced.tsx`: 시간 표시 범위 조정
- 시간별 그리드 높이 최적화
- 현재시간 인디케이터 위치 재조정

#### 구현 코드
```typescript
// packages/web/src/components/Calendar/DayView.tsx
const HOURS = Array.from({ length: 10 }, (_, i) => i + 9) // 9-18시

// 시간 표시 포맷
{format(new Date().setHours(hour, 0, 0, 0), 'HH:mm')}
```

### 2. 태그 시스템 구현 🏷️
**목적**: 일정 분류 및 필터링 강화

#### 작업 내용
- 이벤트 모델에 tags 필드 추가
- 태그 추가/제거 UI 구현
- 태그별 색상 자동 지정
- 태그 필터링 기능

#### 구현 구조
```typescript
// API 모델 확장
interface CalendarEvent {
  id: string
  title: string
  start_time: string
  end_time: string
  all_day: boolean
  description?: string
  location?: string
  color?: string
  tags: string[] // 추가
}

// 태그 컴포넌트
<TagInput 
  tags={event.tags}
  onTagAdd={handleTagAdd}
  onTagRemove={handleTagRemove}
  suggestions={['업무', '개인', '건강', '학습']}
/>
```

### 3. 할일 통합 관리 ✅
**현재**: 별도 박스
**개선**: 일정 하단에 통합 표시

#### 작업 내용
- 할일을 캘린더 이벤트 타입으로 통합
- `event_type: 'todo'` 필드 추가
- 일정 목록 하단에 할일 표시
- 체크박스 토글 기능
- 할일 추가/삭제 인터페이스

#### UI 레이아웃
```
📅 오늘의 일정 (3개)
├── 09:00 - 팀 미팅
├── 14:00 - 고객 상담
└── 16:00 - 프로젝트 리뷰

✅ 오늘의 할일 (2개)
├── ☐ 보고서 작성
└── ☑ 장보기 (완료)

➕ 새 할일 추가
```

### 4. 생년월일시 설정 🎂
**위치**: 설정 페이지 최상단
**목적**: 개인화된 사주 운세 제공

#### 작업 내용
- 설정 페이지에 생년월일시 입력 폼 추가
- 음력/양력 선택 옵션
- 시간 선택 (정확한 사주 계산)
- 로컬스토리지 저장
- 전역 사용자 컨텍스트 생성

#### 구현 코드
```typescript
// UserContext.tsx
interface UserProfile {
  birthDate: string // YYYY-MM-DD
  birthTime: string // HH:mm
  isLunar: boolean
  gender: 'male' | 'female'
  name?: string
}

// 설정 페이지 컴포넌트
<BirthInfoForm
  onSave={handleSaveProfile}
  initialData={userProfile}
  showTimezone={true}
/>
```

### 5. 사주 기반 개인화 시스템 🔮
**연동 범위**: 운세, 추천 일정 시간, 길흉일 표시

#### 작업 내용
- 사주 계산 엔진 구현
- 개인별 운세 알고리즘
- 일간 좋은 시간/나쁜 시간 표시
- 개인 맞춤 조언 시스템

#### 데이터 연동
```
생년월일시 → 사주팔자 → 개인운세 → 캘린더 표시
     ↓           ↓          ↓
  음양오행     십성분석    길흉시간대
```

## 🔧 기술적 구현 계획

### Phase 1: 기본 UI 개선 (1-2시간)
1. ✅ 사주차트 다크모드 개선 (완료)
2. 🔄 일간뷰 시간대 9-18시 변경
3. 🔄 할일 통합 레이아웃 적용

### Phase 2: 데이터 모델 확장 (2-3시간)
1. CalendarEvent 모델에 tags, event_type 추가
2. 백엔드 API 스키마 업데이트
3. 할일 CRUD API 구현

### Phase 3: 사용자 프로필 시스템 (3-4시간)
1. UserContext 및 생년월일시 저장
2. 설정 페이지 UI 구현
3. 사주 계산 기초 로직

### Phase 4: 개인화 운세 시스템 (4-5시간)
1. 사주팔자 계산 엔진
2. 개인별 운세 데이터 생성
3. 캘린더와 운세 연동

## 📊 우선순위

### High (즉시 실행)
- [x] 사주차트 다크모드 가시성 개선
- [ ] 일간뷰 시간대 9-18시 변경
- [ ] 할일 통합 UI 구현

### Medium (이번 주 내)
- [ ] 태그 시스템 구현
- [ ] 생년월일시 설정 기능
- [ ] 기본 사주 계산

### Low (다음 주)
- [ ] 고급 사주 분석
- [ ] 개인화 추천 시스템
- [ ] 길흉일 캘린더 표시

## 🚀 실행 단계

### Step 1: 환경 준비
```bash
# 개발 서버 실행
cd packages/web && npx vite --port 4000
cd packages/backend/services/calendar && CALENDAR_SERVICE_PORT=4001 npm run dev
```

### Step 2: 파일 수정 순서
1. `packages/web/src/components/Calendar/DayView.tsx`
2. `packages/web/src/components/Calendar/DayViewEnhanced.tsx`
3. `packages/web/src/services/api.ts` (타입 확장)
4. `packages/web/src/pages/SettingsPage.tsx`

### Step 3: 테스트 및 검증
- [ ] 각 뷰 전환 동작 확인
- [ ] 다크모드 토글 테스트
- [ ] API 연동 검증
- [ ] 모바일 반응형 확인

## 📝 참고사항

### 기존 코드 구조
```
packages/web/src/
├── components/
│   ├── Calendar/
│   │   ├── DayView.tsx (기본 일간뷰)
│   │   └── DayViewEnhanced.tsx (강화된 일간뷰)
│   ├── Fortune/
│   │   └── TodayFortuneWidget.tsx (운세 위젯)
│   └── saju/
│       └── charts/
│           └── SixAreaChart.tsx (사주 차트)
├── contexts/
│   └── CalendarContext.tsx (캘린더 상태)
└── services/
    └── api.ts (API 호출)
```

### 포트 정책
- **프론트엔드**: 4000 (고정)
- **백엔드**: 4001 (고정)
- **절대 다른 포트 사용 금지**

### Git 커밋 규칙
```bash
git commit -m "feat: 캘린더 일간뷰 시간대 9-18시 변경

- DayView 시간 표시 범위 최적화
- 업무시간 중심 UI 개선
- 시각적 가독성 향상

🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

## ✅ 완료 체크리스트

- [x] 사주분석 레이더 차트 다크모드 가시성 개선
  - 다크모드에서 차트 라인 밝기 증가 (rgba(147, 197, 253, 1))
  - 테두리 두께 3px → 4px로 증가
  - 포인트 크기 6px → 7px로 증가
  - 라벨 색상 밝게 조정 (#e5e7eb)
- [ ] 일간뷰 9시-18시 시간대 변경
- [ ] 태그 기능 구현
- [ ] 할일 통합 관리
- [ ] 설정 페이지 생년월일시 입력
- [ ] 사주 기반 개인화 시스템

---

*이 작업지시서는 운명나침반 캘린더 앱의 사용성과 개인화 기능을 대폭 향상시키기 위한 종합 계획서입니다.*