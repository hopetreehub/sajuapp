<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diary Modal Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-button {
            background-color: #6366f1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        .test-button:hover {
            background-color: #5147e7;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            background-color: white;
            border-left: 4px solid #6366f1;
        }
        .iframe-container {
            margin: 20px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            height: 600px;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <h1>ğŸ“ DiaryModal API ì—°ë™ í…ŒìŠ¤íŠ¸</h1>

    <div class="status">
        <h3>í…ŒìŠ¤íŠ¸ í™˜ê²½</h3>
        <ul>
            <li>âœ… í”„ë¡ íŠ¸ì—”ë“œ: http://localhost:4001</li>
            <li>âœ… Diary Service: http://localhost:5002</li>
            <li>âœ… API ì—°ë™ ì™„ë£Œ</li>
        </ul>
    </div>

    <div class="status">
        <h3>í…ŒìŠ¤íŠ¸ ë°©ë²•</h3>
        <ol>
            <li>ì•„ë˜ "ì•± ì—´ê¸°" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ìº˜ë¦°ë” ì•±ì„ ì—½ë‹ˆë‹¤</li>
            <li>ìº˜ë¦°ë”ì—ì„œ ë‚ ì§œë¥¼ í´ë¦­í•˜ì—¬ ì¼ê¸° ëª¨ë‹¬ì„ ì—½ë‹ˆë‹¤</li>
            <li>ì¼ê¸°ë¥¼ ì‘ì„±í•˜ê³  ì €ì¥ ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤</li>
            <li>ëª¨ë‹¬ì´ ë‹«íˆê³  ì¼ê¸°ê°€ ì €ì¥ë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤</li>
            <li>ë‹¤ì‹œ ê°™ì€ ë‚ ì§œë¥¼ í´ë¦­í•˜ì—¬ ì €ì¥ëœ ì¼ê¸°ê°€ ë¡œë“œë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤</li>
        </ol>
    </div>

    <div>
        <button class="test-button" onclick="openApp()">ğŸ“± ì•± ì—´ê¸° (localhost:4001)</button>
        <button class="test-button" onclick="testAPI()">ğŸ” API í…ŒìŠ¤íŠ¸</button>
        <button class="test-button" onclick="checkStatus()">ğŸ“Š ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸</button>
    </div>

    <div class="iframe-container">
        <iframe id="app-frame" src="about:blank"></iframe>
    </div>

    <div id="test-results" class="status" style="display: none;">
        <h3>í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3>
        <div id="results-content"></div>
    </div>

    <script>
        function openApp() {
            const iframe = document.getElementById('app-frame');
            iframe.src = 'http://localhost:4001';
        }

        async function testAPI() {
            const resultsDiv = document.getElementById('test-results');
            const contentDiv = document.getElementById('results-content');

            try {
                // ê±´ê°• ìƒíƒœ í™•ì¸
                const healthResponse = await fetch('http://localhost:5002/health');
                const healthData = await healthResponse.json();

                // ì¼ê¸° ì¡°íšŒ í…ŒìŠ¤íŠ¸
                const diaryResponse = await fetch('http://localhost:5002/api/diaries/2025-09-16', {
                    headers: {
                        'x-user-id': 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11'
                    }
                });

                let diaryData = null;
                if (diaryResponse.ok) {
                    diaryData = await diaryResponse.json();
                }

                contentDiv.innerHTML = `
                    <h4>âœ… API í…ŒìŠ¤íŠ¸ ì„±ê³µ</h4>
                    <p><strong>ì„œë¹„ìŠ¤ ìƒíƒœ:</strong> ${healthData.status}</p>
                    <p><strong>íƒ€ì„ìŠ¤íƒ¬í”„:</strong> ${healthData.timestamp}</p>
                    ${diaryData ? `
                        <p><strong>ì˜¤ëŠ˜ ì¼ê¸°:</strong></p>
                        <ul>
                            <li>ë‚´ìš©: ${diaryData.content}</li>
                            <li>ê¸°ë¶„: ${diaryData.mood}</li>
                            <li>ì‘ì„±ì‹œê°„: ${diaryData.created_at}</li>
                        </ul>
                    ` : '<p><strong>ì˜¤ëŠ˜ ì¼ê¸°:</strong> ì—†ìŒ</p>'}
                `;

                resultsDiv.style.display = 'block';

            } catch (error) {
                contentDiv.innerHTML = `
                    <h4>âŒ API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨</h4>
                    <p>ì—ëŸ¬: ${error.message}</p>
                    <p>CORS ì—ëŸ¬ì¸ ê²½ìš°, ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ http://localhost:4001 ì— ì ‘ì†í•˜ì—¬ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.</p>
                `;
                resultsDiv.style.display = 'block';
            }
        }

        function checkStatus() {
            const contentDiv = document.getElementById('results-content');
            const resultsDiv = document.getElementById('test-results');

            contentDiv.innerHTML = `
                <h4>ğŸ“Š ì„œë¹„ìŠ¤ ìƒíƒœ</h4>
                <ul>
                    <li>âœ… í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„: http://localhost:4001 (ì‹¤í–‰ ì¤‘)</li>
                    <li>âœ… Diary Service: http://localhost:5002 (ì‹¤í–‰ ì¤‘)</li>
                    <li>âœ… API ì—°ë™: ì™„ë£Œ</li>
                    <li>âœ… DiaryModal ì»´í¬ë„ŒíŠ¸: ì—…ë°ì´íŠ¸ ì™„ë£Œ</li>
                </ul>
                <p><strong>ë‹¤ìŒ ë‹¨ê³„:</strong> ì•± ì—´ê¸° ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì‹¤ì œ ë¸Œë¼ìš°ì €ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.</p>
            `;
            resultsDiv.style.display = 'block';
        }
    </script>
</body>
</html>