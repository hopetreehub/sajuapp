# 궁합 분석 디테일 개선 작업지시서

## 📋 프로젝트 개요
현재 기본적인 5가지 카테고리(성격/애정/재물/건강/미래)로만 궁합을 분석하고 있으나, 
더욱 상세하고 전문적인 궁합 분석을 제공하기 위해 세부 항목을 대폭 확장한다.

## 🎯 개선 목표
**만세력 기반의 정교한 궁합 분석 시스템으로 업그레이드하여 전문 사주 상담 수준의 디테일 제공**

## 🔍 1단계: 궁합 분석 세부 항목 설계

### 1.1 기본 5대 궁합 (현재)
- 성격 궁합 (십신/오행 분석)
- 애정 궁합 (지지관계/음양조화)
- 재물 궁합 (재성 분석)
- 건강 궁합 (오행 균형)
- 미래 궁합 (삼합/육합)

### 1.2 확장된 20가지 세부 궁합 항목 (신규)

#### 💑 관계성 분석 (7개)
1. **첫인상 궁합** - 년주 간지 조합 분석
2. **대화소통 궁합** - 월주 중심 소통 능력
3. **가치관 궁합** - 일간 십신 관계
4. **생활패턴 궁합** - 시주 기반 일상 리듬
5. **갈등해결 궁합** - 충/형/파해 관계
6. **정서적 궁합** - 수(水) 오행 조화도
7. **신뢰도 궁합** - 토(土) 오행 안정성

#### 💰 현실적 분석 (5개)
8. **경제관념 궁합** - 재성(정재/편재) 분포
9. **직업운 궁합** - 관성(정관/편관) 조화
10. **주거환경 궁합** - 인성(정인/편인) 안정도
11. **자녀운 궁합** - 식상(식신/상관) 관계
12. **시댁/처가 궁합** - 년주/월주 관계성
13. **사회생활 궁합** - 겁재/비견 분포

#### 🌟 심층 분석 (4개)
14. **성적 궁합** - 화(火) 오행과 도화살
15. **종교/신앙 궁합** - 인성과 식신 관계
16. **여행/취미 궁합** - 역마살과 화개살
17. **노후생활 궁합** - 금(金) 오행 안정도

#### 🔮 특수 분석 (4개)
18. **천을귀인 궁합** - 귀인 보유 여부
19. **도화살 영향** - 이성 관계 복잡도
20. **공망 분석** - 허무함과 공허감 지수

## 🛠 2단계: 기술 구현 계획

### 2.1 데이터 구조 확장
```typescript
interface DetailedCompatibilityResult {
  // 기본 정보
  totalScore: number;
  mainCategories: CategoryScore[];  // 기존 5대 카테고리
  
  // 세부 분석
  detailedAnalysis: {
    relationship: RelationshipAnalysis;  // 관계성 7항목
    practical: PracticalAnalysis;        // 현실적 5항목
    depth: DepthAnalysis;                // 심층 4항목
    special: SpecialAnalysis;            // 특수 4항목
  };
  
  // 종합 조언
  professionalAdvice: {
    strengths: string[];      // 장점 3-5개
    weaknesses: string[];     // 주의점 3-5개
    recommendations: string[]; // 개선방안 3-5개
  };
  
  // 시각화 데이터
  visualData: {
    radarChart: ChartData;    // 레이더 차트용
    barChart: ChartData;      // 막대 그래프용
    compatibility Matrix: number[][]; // 히트맵용
  };
}
```

### 2.2 계산 로직 세분화
```typescript
// 각 세부 항목별 전용 계산 함수
function calculateFirstImpressionScore(saju1, saju2): DetailScore
function calculateCommunicationScore(saju1, saju2): DetailScore
function calculateValueSystemScore(saju1, saju2): DetailScore
// ... 20개 항목별 함수

// 결과에 포함될 상세 정보
interface DetailScore {
  score: number;        // 0-100 점수
  level: string;        // 매우좋음/좋음/보통/주의/위험
  description: string;  // 상세 설명
  factors: {
    positive: string[]; // 긍정 요인들
    negative: string[]; // 부정 요인들
  };
}
```

### 2.3 UI/UX 개선안

#### A. 탭 방식 구성
```
[종합] [관계성] [현실성] [심층분석] [특수분석] [전문상담]
```

#### B. 아코디언 방식
```
▼ 종합 점수 및 요약
▼ 관계성 분석 (7항목)
  - 첫인상 궁합: 85점 ⭐⭐⭐⭐
  - 대화소통 궁합: 72점 ⭐⭐⭐
  ...
▼ 현실적 분석 (5항목)
▼ 심층 분석 (4항목)
▼ 특수 분석 (4항목)
```

#### C. 대시보드 방식
```
┌─────────────┬─────────────┬─────────────┐
│  종합점수   │  최고항목   │  주의항목   │
│    78점     │ 가치관 92점 │ 갈등 45점   │
├─────────────┴─────────────┴─────────────┤
│         20개 항목 히트맵 시각화         │
├─────────────────────────────────────────┤
│      상세 분석 결과 (스크롤 영역)        │
└─────────────────────────────────────────┘
```

## 📊 3단계: 시각화 강화

### 3.1 차트 종류 다양화
- **스파이더 차트**: 5대 카테고리 + 20개 세부항목
- **히트맵**: 항목별 점수를 색상으로 표현
- **막대 그래프**: 긍정/부정 요인 비교
- **도넛 차트**: 카테고리별 비중 표시
- **라인 그래프**: 미래 예측 (대운/세운 반영)

### 3.2 인터랙티브 요소
- 항목 클릭 시 상세 설명 팝업
- 마우스 오버 시 툴팁 표시
- 점수별 애니메이션 효과
- 필터링 기능 (관심 항목만 보기)

## 🎨 4단계: UI 컴포넌트 구조

```
CompatibilityPage/
├── CompatibilityOverview       // 종합 요약
├── DetailedAnalysisTabs        // 탭 네비게이션
│   ├── RelationshipTab         // 관계성 분석
│   ├── PracticalTab            // 현실적 분석
│   ├── DepthTab                // 심층 분석
│   └── SpecialTab              // 특수 분석
├── CompatibilityCharts         // 차트 컨테이너
│   ├── EnhancedRadarChart      // 강화된 레이더
│   ├── HeatmapChart            // 히트맵
│   └── ComparisonBarChart     // 비교 막대
├── ProfessionalAdvicePanel     // 전문 조언
└── CompatibilityReport         // PDF 출력용
```

## 📝 5단계: 구현 우선순위

### Phase 1 (즉시)
1. 관계성 7개 항목 계산 로직 구현
2. 탭 UI 구조 생성
3. 기본 점수 표시

### Phase 2 (다음)
1. 현실적 5개 항목 추가
2. 히트맵 차트 구현
3. 상세 설명 컴포넌트

### Phase 3 (추후)
1. 심층/특수 분석 완성
2. PDF 리포트 생성
3. 공유 기능 추가

## ⚠️ 주의사항

1. **성능 최적화**
   - 20개 항목 계산 시 지연 방지
   - 단계별 로딩 또는 웹워커 활용
   - 결과 캐싱 구현

2. **사용자 경험**
   - 복잡도 증가로 인한 혼란 방지
   - 점진적 정보 공개 (Progressive Disclosure)
   - 초보자/전문가 모드 구분

3. **정확도 검증**
   - 각 항목별 계산 로직 검증
   - 실제 커플 데이터로 테스트
   - 전문가 자문 고려

## 🎯 기대 효과

1. **차별화된 서비스**: 타 사주 앱 대비 디테일한 분석
2. **신뢰도 향상**: 전문적이고 체계적인 결과 제공
3. **사용자 만족도**: 궁금증 해소 및 재방문율 증가
4. **수익 모델**: 프리미엄 상세 분석 유료화 가능

## 📅 예상 일정

- **설계 및 기획**: 1일
- **백엔드 로직 구현**: 2-3일  
- **프론트엔드 UI 개발**: 2-3일
- **테스트 및 검증**: 1-2일
- **총 예상 기간**: 1주일

---
*작성일: 2025-09-03*
*작업 담당: Claude Code*
*상태: 대기 중*