# 🔄 운명나침반 프로젝트 - 작업 연속성 지침서

## 📊 현재 프로젝트 상태 분석

### ✅ 최근 완료된 주요 기능들
1. **대시보드 페이지 구현** (72131ec)
2. **알림 시스템 구현** (fb41bb8)
3. **통합 검색 시스템 구현** (f55fc5c)
4. **음력 달력 통합 구현** (da2efb7)
5. **DiaryModal 백엔드 연동 완성** (64dec92)

### 🚧 현재 개발 진행 상태

#### 포트 구성 현황
- **프론트엔드**: 포트 4000 (고정)
- **캘린더 서비스**: 포트 4001 (CALENDAR_SERVICE_PORT)
- **API Gateway**: 포트 4003 (기본값)
- **다이어리 서비스**: 포트 4004 (diary service)

#### API 연동 상태
- **캘린더 API**: `packages/web/src/services/api.ts:3` - 포트 4003 사용
- **다이어리 API**: `packages/web/src/services/api.ts:266` - 포트 4004 직접 연결
- **일정/태그 관리**: 완전 구현됨
- **할일 관리**: CalendarContext에서 메모리 기반 관리

## 🎯 즉시 실행 가능한 작업 재개 단계

### 1단계: 개발 환경 복구 (필수)

```bash
# 1. 프론트엔드 서버 시작 (포트 4000 고정)
cd packages/web
npx vite --port 4000

# 2. 캘린더 백엔드 서비스 시작
cd packages/backend/services/calendar
CALENDAR_SERVICE_PORT=4001 npm run dev

# 포트 충돌 시 해결
netstat -ano | findstr ":4000"
taskkill /PID [PID번호] /F
```

### 2단계: 현재 상태 확인

```bash
# Git 상태 확인
git status
git log --oneline -5

# 현재 브랜치 확인
git branch

# 변경되지 않은 파일들 확인
ls -la
```

### 3단계: 개발 재개 준비

```bash
# 타입 체크 및 린트 실행
cd packages/web
npm run lint
npm run typecheck  # 있는 경우

# 브라우저에서 동작 확인
# http://localhost:4000 접속하여 기본 동작 테스트
```

## 🔍 핵심 파일 위치 및 역할

### 프론트엔드 핵심 파일들
```
packages/web/src/
├── services/api.ts           # API 통합 인터페이스 (포트 설정 포함)
├── contexts/CalendarContext.tsx  # 캘린더 상태 관리
├── components/Calendar/      # 캘린더 뷰 컴포넌트들
│   ├── MonthView.tsx        # 월간 뷰 (할일 표시 구현됨)
│   ├── WeekView.tsx         # 주간 뷰
│   └── DayView.tsx          # 일간 뷰
├── components/DiaryModal.tsx # 다이어리 모달 (백엔드 연동 완료)
├── pages/DashboardPage.tsx   # 대시보드 페이지
└── App.tsx                   # 메인 앱 라우팅
```

### 백엔드 서비스 구조
```
packages/backend/
├── api-gateway/              # API 게이트웨이 (포트 4003)
└── services/
    ├── calendar/             # 캘린더 서비스 (포트 4001)
    └── diary/                # 다이어리 서비스 (포트 4004)
```

## 📝 진행 중인 작업 및 다음 단계

### 🟡 현재 진행 가능한 우선순위 작업들

1. **할일 관리 백엔드 연동**
   - 현재: CalendarContext에서 메모리 관리
   - 필요: 캘린더 서비스와 연동하여 영구 저장
   - 파일: `packages/web/src/contexts/CalendarContext.tsx:6-153`

2. **캘린더 뷰 간 할일 동기화 개선**
   - 현재: MonthView에서 할일 표시 구현됨
   - 필요: WeekView, DayView에서도 동일 기능 구현

3. **다이어리 서비스 안정화**
   - 현재: 기본 CRUD 구현 완료
   - 필요: 에러 처리 및 로딩 상태 개선

### 🟢 새로운 기능 개발 후보

1. **사주 해석 고도화**
   - `packages/web/src/services/api.ts:121-243`에 구조 완성됨
   - 백엔드 해석 서비스 구현 필요

2. **음력 달력 연동 완성**
   - `packages/web/src/utils/lunarCalendar.ts` 기반 완성

3. **사용자 인증 시스템**
   - 현재는 임시 사용자 ID 사용 중
   - `packages/web/src/services/api.ts:268` 참조

## ⚡ 빠른 작업 재개를 위한 체크리스트

### 🔧 개발 환경 준비
- [ ] 프론트엔드 서버 포트 4000으로 실행
- [ ] 캘린더 서비스 포트 4001으로 실행  
- [ ] 브라우저에서 http://localhost:4000 접속 확인
- [ ] 콘솔 에러 없음 확인
- [ ] 네트워크 탭에서 API 호출 확인

### 🎯 우선 작업 선택
- [ ] 할일 백엔드 연동하기
- [ ] 캘린더 뷰 할일 동기화 완성하기
- [ ] 다이어리 에러 처리 개선하기
- [ ] 사주 해석 서비스 구현하기

### 📋 작업 완료 후 필수사항
- [ ] TodoWrite로 진행상황 추적
- [ ] TypeScript 컴파일 에러 해결
- [ ] ESLint 경고 해결
- [ ] 브라우저에서 기능 테스트
- [ ] Git 커밋 (상세한 커밋 메시지 작성)

## 🚨 주의사항 및 문제 해결

### 포트 관련 문제
- **절대 규칙**: 프론트엔드는 무조건 포트 4000만 사용
- **충돌 해결**: `netstat -ano | findstr ":4000"` 후 프로세스 종료
- **백엔드 연결**: API_URL 환경변수 확인 (`services/api.ts:3`)

### API 연결 문제
```typescript
// services/api.ts의 현재 설정
const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:4003';

// 다이어리 서비스는 직접 연결
axios.get('http://localhost:4004/api/diaries', ...)
```

### 타입 정의 일관성
- **CalendarEvent**: `services/api.ts:12-26` 정의 사용
- **필드명**: `start_time`, `end_time`, `all_day` (snake_case)
- **Todo 타입**: `CalendarContext.tsx:6-14` 정의 사용

## 📈 개발 진행 추적 방법

### TodoWrite 활용 패턴
```typescript
// 작업 시작 시
TodoWrite([
  { content: "할일 백엔드 연동 구현", status: "in_progress", activeForm: "할일 백엔드 연동 구현 중" },
  { content: "API 엔드포인트 테스트", status: "pending", activeForm: "API 엔드포인트 테스트 중" }
])

// 작업 완료 시
TodoWrite([
  { content: "할일 백엔드 연동 구현", status: "completed", activeForm: "할일 백엔드 연동 구현 중" },
  { content: "API 엔드포인트 테스트", status: "completed", activeForm: "API 엔드포인트 테스트 중" }
])
```

### Git 커밋 패턴
```bash
git commit -m "$(cat <<'EOF'
feat: 할일 관리 백엔드 연동 완성

- CalendarContext를 캘린더 서비스 API와 연동
- 할일 CRUD 작업을 영구 저장소로 이전
- 로딩 상태 및 에러 처리 추가
- 모든 캘린더 뷰에서 할일 동기화 완성

🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

---

## 💡 작업 재개 시 첫 번째 액션

1. **서버 실행**부터 시작
2. **브라우저 테스트**로 현재 상태 확인  
3. **TodoWrite로 계획 수립**
4. **단계별 구현 및 테스트**
5. **완료 후 커밋**

이 지침서를 통해 언제든지 작업을 중단했던 지점에서 즉시 재개할 수 있습니다.